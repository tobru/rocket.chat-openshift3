{"version":3,"sources":["meteor://ðŸ’»app/server/lib/cordova/facebook-login.coffee"],"names":[],"mappings":";;;;;;;;;AAAA;;AAAA,QAAQ,CAAC,oBAAT,CAA8B,SAAC,YAAD;AAC7B;AAAA,MAAG,aAAgB,CAAC,OAApB;AACC,WAAO,MAAP,CADD;GAAA;AAAA,EAGA,eAAe,YAAY,CAAC,YAH5B;AAAA,EAIA,WAAW,YAAY,YAAY,CAAC,WAAzB,CAJX;AAAA,EAMA,cACC;AAAA,iBAAa,YAAY,CAAC,WAA1B;AAAA,IACA,WAAW,CAAC,EAAC,SAAF,IAAc,CAAC,OAAO,YAAY,CAAC,SAArB,CADzB;GAPD;AAAA,EAUA,cAAc,CAAC,IAAD,EAAO,OAAP,EAAgB,MAAhB,EAAwB,YAAxB,EAAsC,WAAtC,EAAmD,MAAnD,EAA2D,UAA3D,EAAuE,QAAvE,EAAiF,QAAjF,EAA2F,WAA3F,CAVd;AAAA,EAYA,SAAS,CAAC,CAAC,IAAF,CAAO,QAAP,EAAiB,WAAjB,CAZT;AAAA,EAaA,CAAC,CAAC,MAAF,CAAS,WAAT,EAAsB,MAAtB,CAbA;AAAA,EAeA,UAAU;AAAA,IAAC,SAAS,EAAV;GAfV;AAAA,EAgBA,gBAAgB,CAAC,CAAC,IAAF,CAAO,QAAP,EAAiB,WAAjB,CAhBhB;AAAA,EAiBA,CAAC,CAAC,MAAF,CAAS,OAAO,CAAC,OAAjB,EAA0B,aAA1B,CAjBA;AAmBA,SAAO,QAAQ,CAAC,qCAAT,CAA+C,UAA/C,EAA2D,WAA3D,EAAwE,OAAxE,CAAP,CApB6B;AAAA,CAA9B;;AAAA,WAuBA,GAAc,SAAC,WAAD;AACb;AAAA;AACC,WAAO,IAAI,CAAC,GAAL,CAAS,+BAAT,EAA0C;AAAA,MAAC,QAAQ;AAAA,QAAC,cAAc,WAAf;OAAT;KAA1C,CAAgF,CAAC,IAAxF,CADD;GAAA;AAIC,IADK,YACL;AAAA,UAAM,CAAC,CAAC,MAAF,CAAa,UAAM,6CAA6C,GAAG,CAAC,OAAvD,CAAb,EAA8E;AAAA,MAAC,UAAU,GAAG,CAAC,QAAf;KAA9E,CAAN,CAJD;GADa;AAAA,CAvBd","file":"/server/lib/cordova/facebook-login.coffee.js","sourcesContent":["Accounts.registerLoginHandler (loginRequest) ->\n\tif not loginRequest.cordova\n\t\treturn undefined\n\n\tloginRequest = loginRequest.authResponse\n\tidentity = getIdentity(loginRequest.accessToken)\n\n\tserviceData =\n\t\taccessToken: loginRequest.accessToken\n\t\texpiresAt: (+new Date) + (1000 * loginRequest.expiresIn)\n\n\twhitelisted = ['id', 'email', 'name', 'first_name', 'last_name', 'link', 'username', 'gender', 'locale', 'age_range']\n\n\tfields = _.pick(identity, whitelisted)\n\t_.extend(serviceData, fields)\n\n\toptions = {profile: {}}\n\tprofileFields = _.pick(identity, whitelisted)\n\t_.extend(options.profile, profileFields)\n\n\treturn Accounts.updateOrCreateUserFromExternalService(\"facebook\", serviceData, options)\n\n\ngetIdentity = (accessToken) ->\n\ttry\n\t\treturn HTTP.get(\"https://graph.facebook.com/me\", {params: {access_token: accessToken}}).data\n\n\tcatch err\n\t\tthrow _.extend new Error(\"Failed to fetch identity from Facebook. \" + err.message), {response: err.response}"]}