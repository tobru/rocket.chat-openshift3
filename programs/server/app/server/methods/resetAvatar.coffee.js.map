{"version":3,"sources":["meteor://ğŸ’»app/server/methods/resetAvatar.coffee"],"names":[],"mappings":";;;;;;;;;AAAA,MAAM,CAAC,OAAP,CACC;AAAA,eAAa,SAAC,KAAD,EAAQ,OAAR;AACZ;AAAA,eAAa,CAAC,MAAP,EAAP;AACC,YAAU,UAAM,CAAC,KAAP,CAAa,oBAAb,EAAmC,cAAnC,EAAmD;AAAA,QAAE,QAAQ,aAAV;OAAnD,CAAV,CADD;KAAA;AAGA,mBAAiB,CAAC,QAAQ,CAAC,GAApB,CAAwB,gCAAxB,CAAP;AACC,YAAU,UAAM,CAAC,KAAP,CAAa,mBAAb,EAAkC,aAAlC,EAAiD;AAAA,QAAE,QAAQ,aAAV;OAAjD,CAAV,CADD;KAHA;AAAA,IAMA,OAAO,MAAM,CAAC,IAAP,EANP;AAAA,IAQA,4BAA4B,CAAC,UAA7B,CAA2C,IAAI,CAAC,QAAN,GAAe,MAAzD,CARA;AAAA,IAUA,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,iBAAxB,CAA0C,IAAI,CAAC,GAA/C,CAVA;AAAA,IAYA,UAAU,CAAC,aAAa,CAAC,SAAzB,CAAmC,cAAnC,EAAmD;AAAA,MAAC,UAAU,IAAI,CAAC,QAAhB;KAAnD,CAZA,CADY;EAAA,CAAb;CADD;;AAAA,cAkBc,CAAC,OAAf,CACC;AAAA,QAAM,QAAN;AAAA,EACA,MAAM,aADN;AAAA,EAEA,QAAQ;AAAG,WAAO,IAAP,CAAH;EAAA,CAFR;CADD,EAIE,CAJF,EAIK,KAJL,CAlBA","file":"/server/methods/resetAvatar.coffee.js","sourcesContent":["Meteor.methods\n\tresetAvatar: (image, service) ->\n\t\tunless Meteor.userId()\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'resetAvatar' });\n\n\t\tunless RocketChat.settings.get(\"Accounts_AllowUserAvatarChange\")\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'resetAvatar' });\n\n\t\tuser = Meteor.user()\n\n\t\tRocketChatFileAvatarInstance.deleteFile \"#{user.username}.jpg\"\n\n\t\tRocketChat.models.Users.unsetAvatarOrigin user._id\n\n\t\tRocketChat.Notifications.notifyAll 'updateAvatar', {username: user.username}\n\t\treturn\n\n# Limit changing avatar once per minute\nDDPRateLimiter.addRule\n\ttype: 'method'\n\tname: 'resetAvatar'\n\tuserId: -> return true\n, 1, 60000\n"]}