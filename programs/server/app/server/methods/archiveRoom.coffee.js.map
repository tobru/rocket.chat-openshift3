{"version":3,"sources":["meteor://ðŸ’»app/server/methods/archiveRoom.coffee"],"names":[],"mappings":";;;;;;;;;AAAA,MAAM,CAAC,OAAP,CACC;AAAA,eAAa,SAAC,GAAD;AACZ;AAAA,QAAG,OAAU,CAAC,MAAP,EAAP;AACC,YAAU,UAAM,CAAC,KAAP,CAAa,oBAAb,EAAmC,cAAnC,EAAmD;AAAA,QAAE,QAAQ,aAAV;OAAnD,CAAV,CADD;KAAA;AAAA,IAGA,OAAO,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,WAAxB,CAAoC,GAApC,CAHP;AAKA;AACC,YAAU,UAAM,CAAC,KAAP,CAAa,oBAAb,EAAmC,cAAnC,EAAmD;AAAA,QAAE,QAAQ,aAAV;OAAnD,CAAV,CADD;KALA;AAQA,mBAAiB,CAAC,KAAK,CAAC,aAAjB,CAA+B,MAAM,CAAC,MAAP,EAA/B,EAAgD,cAAhD,EAAgE,IAAI,CAAC,GAArE,CAAP;AACC,YAAU,UAAM,CAAC,KAAP,CAAa,sBAAb,EAAqC,gBAArC,EAAuD;AAAA,QAAE,QAAQ,aAAV;OAAvD,CAAV,CADD;KARA;AAAA,IAWA,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,WAAxB,CAAoC,GAApC,CAXA;AAaA;AAAA;SAAA;wBAAA;AACC,eAAS,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,iBAAxB,CAA0C,QAA1C,EAAoD;AAAA,QAAE,QAAQ;AAAA,UAAE,UAAU,CAAZ;SAAV;OAApD,CAAT;AACA,UAAO,cAAP;AACC,iBADD;OADA;AAAA,mBAIA,UAAU,CAAC,MAAM,CAAC,aAAa,CAAC,wBAAhC,CAAyD,GAAzD,EAA8D,MAAM,CAAC,GAArE,EAJA,CADD;AAAA;mBAdY;EAAA,CAAb;CADD","file":"/server/methods/archiveRoom.coffee.js","sourcesContent":["Meteor.methods\n\tarchiveRoom: (rid) ->\n\t\tif not Meteor.userId()\n\t\t\tthrow new Meteor.Error 'error-invalid-user', 'Invalid user', { method: 'archiveRoom' }\n\n\t\troom = RocketChat.models.Rooms.findOneById rid\n\n\t\tunless room\n\t\t\tthrow new Meteor.Error 'error-invalid-room', 'Invalid room', { method: 'archiveRoom' }\n\n\t\tunless RocketChat.authz.hasPermission(Meteor.userId(), 'archive-room', room._id)\n\t\t\tthrow new Meteor.Error 'error-not-authorized', 'Not authorized', { method: 'archiveRoom' }\n\n\t\tRocketChat.models.Rooms.archiveById rid\n\n\t\tfor username in room.usernames\n\t\t\tmember = RocketChat.models.Users.findOneByUsername(username, { fields: { username: 1 }})\n\t\t\tif not member?\n\t\t\t\tcontinue\n\n\t\t\tRocketChat.models.Subscriptions.archiveByRoomIdAndUserId rid, member._id\n"]}