{"version":3,"sources":["meteor://üíªapp/server/methods/eraseRoom.coffee"],"names":[],"mappings":";;;;;;;;;AAAA,MAAM,CAAC,OAAP,CACC;AAAA,aAAW,SAAC,GAAD;AACV;AAAA,QAAG,OAAU,CAAC,MAAP,EAAP;AACC,YAAU,UAAM,CAAC,KAAP,CAAa,oBAAb,EAAmC,cAAnC,EAAmD;AAAA,QAAE,QAAQ,WAAV;OAAnD,CAAV,CADD;KAAA;AAAA,IAGA,SAAS,MAAM,CAAC,MAAP,EAHT;AAAA,IAKA,yEAAmD,CAAE,UALrD;AAOA,QAAG,UAAU,CAAC,KAAK,CAAC,aAAjB,CAAgC,MAAhC,EAAwC,YAAU,QAAlD,EAA8D,GAA9D,CAAH;AAGC,gBAAU,CAAC,MAAM,CAAC,QAAQ,CAAC,cAA3B,CAA0C,GAA1C;AAAA,MACA,UAAU,CAAC,MAAM,CAAC,aAAa,CAAC,cAAhC,CAA+C,GAA/C,CADA;aAEA,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,UAAxB,CAAmC,GAAnC,EALD;KAAA;AAQC,YAAU,UAAM,CAAC,KAAP,CAAa,mBAAb,EAAkC,aAAlC,EAAiD;AAAA,QAAE,QAAQ,WAAV;OAAjD,CAAV,CARD;KARU;EAAA,CAAX;CADD","file":"/server/methods/eraseRoom.coffee.js","sourcesContent":["Meteor.methods\n\teraseRoom: (rid) ->\n\t\tif not Meteor.userId()\n\t\t\tthrow new Meteor.Error 'error-invalid-user', 'Invalid user', { method: 'eraseRoom' }\n\n\t\tfromId = Meteor.userId()\n\n\t\troomType = RocketChat.models.Rooms.findOneById(rid)?.t\n\n\t\tif RocketChat.authz.hasPermission( fromId, \"delete-#{roomType}\", rid )\n\t\t\t# ChatRoom.update({ _id: rid}, {'$pull': { userWatching: Meteor.userId(), userIn: Meteor.userId() }})\n\n\t\t\tRocketChat.models.Messages.removeByRoomId rid\n\t\t\tRocketChat.models.Subscriptions.removeByRoomId rid\n\t\t\tRocketChat.models.Rooms.removeById rid\n\t\t\t# @TODO remove das mensagens lidas do usu√°rio\n\t\telse\n\t\t\tthrow new Meteor.Error 'error-not-allowed', 'Not allowed', { method: 'eraseRoom' }\n"]}