{"version":3,"sources":["meteor://ðŸ’»app/server/startup/roomPublishes.coffee"],"names":[],"mappings":"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","file":"/server/startup/roomPublishes.coffee.js","sourcesContent":["Meteor.startup ->\n\tRocketChat.roomTypes.setPublish 'c', (identifier) ->\n\t\toptions =\n\t\t\tfields:\n\t\t\t\tname: 1\n\t\t\t\tt: 1\n\t\t\t\tcl: 1\n\t\t\t\tu: 1\n\t\t\t\tusernames: 1\n\t\t\t\ttopic: 1\n\t\t\t\tmuted: 1\n\t\t\t\tarchived: 1\n\t\t\t\tjitsiTimeout: 1\n\t\t\t\tdescription: 1\n\n\t\tif RocketChat.authz.hasPermission(this.userId, 'view-c-room')\n\t\t\treturn RocketChat.models.Rooms.findByTypeAndName 'c', identifier, options\n\t\telse if RocketChat.authz.hasPermission(this.userId, 'view-joined-room')\n\t\t\troomId = RocketChat.models.Subscriptions.findByTypeNameAndUserId('c', identifier, this.userId).fetch()\n\t\t\tif roomId.length > 0\n\t\t\t\treturn RocketChat.models.Rooms.findById(roomId[0]?.rid, options)\n\t\treturn this.ready()\n\n\tRocketChat.roomTypes.setPublish 'p', (identifier) ->\n\t\toptions =\n\t\t\tfields:\n\t\t\t\tname: 1\n\t\t\t\tt: 1\n\t\t\t\tcl: 1\n\t\t\t\tu: 1\n\t\t\t\tusernames: 1\n\t\t\t\ttopic: 1\n\t\t\t\tmuted: 1\n\t\t\t\tarchived: 1\n\t\t\t\tjitsiTimeout: 1\n\t\t\t\tdescription: 1\n\n\t\tuser = RocketChat.models.Users.findOneById this.userId, fields: username: 1\n\t\treturn RocketChat.models.Rooms.findByTypeAndNameContainingUsername 'p', identifier, user.username, options\n\n\tRocketChat.roomTypes.setPublish 'd', (identifier) ->\n\t\toptions =\n\t\t\tfields:\n\t\t\t\tname: 1\n\t\t\t\tt: 1\n\t\t\t\tcl: 1\n\t\t\t\tu: 1\n\t\t\t\tusernames: 1\n\t\t\t\ttopic: 1\n\t\t\t\tjitsiTimeout: 1\n\n\t\tuser = RocketChat.models.Users.findOneById this.userId, fields: username: 1\n\t\tif RocketChat.authz.hasPermission(this.userId, 'view-d-room')\n\t\t\treturn RocketChat.models.Rooms.findByTypeContainigUsernames 'd', [user.username, identifier], options\n\t\treturn this.ready()\n"]}