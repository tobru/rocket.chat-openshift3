{"version":3,"sources":["meteor://ðŸ’»app/server/startup/migrations/v045.js"],"names":[],"mappings":";;;;;;;;AAAA,UAAU,CAAC,UAAU,CAAC,GAAG,CAAC;AACzB,QAAO,EAAE,EAAE;AACX,GAAE,EAAE,YAAW;;;AAGd,MAAI,WAAW,GAAG,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,SAAS,EAAE,EAAE,EAAE,MAAM,EAAE,EAAE,QAAQ,EAAE,CAAC,EAAE,EAAE,IAAI,EAAE,EAAE,SAAS,EAAE,CAAC,CAAC,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC,KAAK,EAAE,CAAC;;AAE5I,MAAI,WAAW,IAAI,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;AAC1C,OAAI,UAAU,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC;;AAEjE,aAAU,CAAC,QAAQ,CAAC,GAAG,CAAC,sBAAsB,EAAG,QAAQ,CAAC,UAAU,CAAC,GAAG,CAAC,EAAG,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,UAAU,EAAE,CAAC,CAAC;GAChH;EACD;CACD,CAAC,CAAC,sE","file":"/server/startup/migrations/v045.js","sourcesContent":["RocketChat.Migrations.add({\n\tversion: 45,\n\tup: function() {\n\n\t\t// finds the latest created visitor\n\t\tvar lastVisitor = RocketChat.models.Users.find({ type: 'visitor' }, { fields: { username: 1 }, sort: { createdAt: -1 }, limit: 1 }).fetch();\n\n\t\tif (lastVisitor && lastVisitor.length > 0) {\n\t\t\tvar lastNumber = lastVisitor[0].username.replace(/^guest\\-/, '');\n\n\t\t\tRocketChat.settings.add('Livechat_guest_count', (parseInt(lastNumber) + 1), { type: 'int', group: 'Livechat' });\n\t\t}\n\t}\n});\n"]}