{"version":3,"sources":["meteor://ðŸ’»app/server/startup/migrations/v030.coffee"],"names":[],"mappings":";;;;;;;;;AAAA,UAAU,CAAC,UAAU,CAAC,GAAtB,CACC;AAAA,WAAS,EAAT;AAAA,EACA,IAAI;AACH;AAAA,uGAA6E,CAAE,cAA/E;AAAA,IACA,qGAA6E,CAAE,cAD/E;AAAA,IAEA,yGAAiF,CAAE,cAFnF;AAAA,IAGA,yGAAiF,CAAE,cAHnF;AAAA,IAMA,UAAU,CAAC,MAAM,CAAC,QAAQ,CAAC,MAA3B,CAAkC;AAAA,MAAC,KAAK,oBAAN;KAAlC,CANA;AAAA,IAOA,UAAU,CAAC,MAAM,CAAC,QAAQ,CAAC,MAA3B,CAAkC;AAAA,MAAC,KAAK,oBAAN;KAAlC,CAPA;AAAA,IAQA,UAAU,CAAC,MAAM,CAAC,QAAQ,CAAC,MAA3B,CAAkC;AAAA,MAAC,KAAK,sBAAN;KAAlC,CARA;AAAA,IASA,UAAU,CAAC,MAAM,CAAC,QAAQ,CAAC,MAA3B,CAAkC;AAAA,MAAC,KAAK,sBAAN;KAAlC,CATA;AAYA,QAAG,uBAAsB,8BAAtB,IAAyD,uBAAsB,4BAA/E,IAAgH,yBAAwB,kBAAxI,IAA+J,yBAAwB,MAA1L;AACC,aADD;KAZA;AAAA,IAeA,UAAU,EAfV;AAiBA,QAAG,0BAAH;AACC,iBAAW,kBAAX,CADD;KAjBA;AAoBA,QAAG,0BAAH;AACC,iBAAW,IAAX;AACA,UAAG,4BAAH;AACC,mBAAW,mBAAmB,oBAAnB,IAA2C,GAA3C,GAAiD,mBAAmB,oBAAnB,CAAjD,GAA4F,GAAvG,CADD;OADA;AAAA,MAGA,WAAW,kBAHX,CADD;KApBA;AA0BA,QAAG,YAAa,EAAhB;aACC,UAAU,CAAC,MAAM,CAAC,QAAQ,CAAC,MAA3B,CACC;AAAA,aAAK,gBAAL;OADD,EAGC;AAAA,cACC;AAAA,iBAAO,OAAP;SADD;AAAA,QAEA,cACC;AAAA,qBAAW,QAAX;SAHD;OAHD,EADD;KA3BG;EAAA,CADJ;CADD","file":"/server/startup/migrations/v030.coffee.js","sourcesContent":["RocketChat.Migrations.add\n\tversion: 30\n\tup: ->\n\t\tWebRTC_STUN_Server = RocketChat.models.Settings.findOne('WebRTC_STUN_Server')?.value\n\t\tWebRTC_TURN_Server = RocketChat.models.Settings.findOne('WebRTC_TURN_Server')?.value\n\t\tWebRTC_TURN_Username = RocketChat.models.Settings.findOne('WebRTC_TURN_Username')?.value\n\t\tWebRTC_TURN_Password = RocketChat.models.Settings.findOne('WebRTC_TURN_Password')?.value\n\n\n\t\tRocketChat.models.Settings.remove({_id: 'WebRTC_STUN_Server'})\n\t\tRocketChat.models.Settings.remove({_id: 'WebRTC_TURN_Server'})\n\t\tRocketChat.models.Settings.remove({_id: 'WebRTC_TURN_Username'})\n\t\tRocketChat.models.Settings.remove({_id: 'WebRTC_TURN_Password'})\n\n\n\t\tif WebRTC_STUN_Server is 'stun:stun.l.google.com:19302' and WebRTC_TURN_Server is 'turn:numb.viagenie.ca:3478' and WebRTC_TURN_Username is 'team@rocket.chat' and WebRTC_TURN_Password is 'demo'\n\t\t\treturn\n\n\t\tservers = ''\n\n\t\tif WebRTC_STUN_Server?\n\t\t\tservers += WebRTC_STUN_Server\n\n\t\tif WebRTC_TURN_Server?\n\t\t\tservers += ', '\n\t\t\tif WebRTC_TURN_Username?\n\t\t\t\tservers += encodeURIComponent(WebRTC_TURN_Username) + ':' + encodeURIComponent(WebRTC_TURN_Password) + '@'\n\t\t\tservers += WebRTC_TURN_Server\n\n\t\tif servers isnt ''\n\t\t\tRocketChat.models.Settings.upsert\n\t\t\t\t_id: 'WebRTC_Servers'\n\t\t\t,\n\t\t\t\t$set:\n\t\t\t\t\tvalue: servers\n\t\t\t\t$setOnInsert:\n\t\t\t\t\tcreatedAt: new Date\n"]}