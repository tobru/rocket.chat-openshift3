{"version":3,"sources":["meteor://ðŸ’»app/server/startup/migrations/v051.js"],"names":[],"mappings":";;;;;;;;AAAA,UAAU,CAAC,UAAU,CAAC,GAAG,CAAC;AACzB,QAAO,EAAE,EAAE;AACX,GAAE,EAAE,YAAW;AACd,YAAU,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,GAAG,EAAE,SAAS,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,EAAE,KAAK,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,EAAC,CAAC,CAAC,OAAO,CAAC,UAAS,IAAI,EAAE;AACvH,OAAI,IAAI,GAAG,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,eAAe,EAAE,IAAI,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC;AAC9E,OAAI,IAAI,EAAE;AACT,cAAU,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,GAAG,EAAE,IAAI,CAAC,GAAG,EAAE,EAAE;AACjD,SAAI,EAAE;AACL,WAAK,EAAE,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,QAAQ;AACjC,aAAO,EAAE,IAAI,CAAC,GAAG;MACjB;KACD,CAAC,CAAC;AACH,cAAU,CAAC,MAAM,CAAC,aAAa,CAAC,MAAM,CAAC,EAAE,GAAG,EAAE,IAAI,CAAC,GAAG,EAAE,EAAE;AACzD,SAAI,EAAE;AACL,UAAI,EAAE,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,QAAQ;MAChC;KACD,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;IACpB;GACD,CAAC,CAAC;EACH;CACD,CAAC,CAAC,sE","file":"/server/startup/migrations/v051.js","sourcesContent":["RocketChat.Migrations.add({\n\tversion: 51,\n\tup: function() {\n\t\tRocketChat.models.Rooms.find({ t: 'l', 'v.token': { $exists: true }, label: { $exists: false }}).forEach(function(room) {\n\t\t\tvar user = RocketChat.models.Users.findOne({ 'profile.token': room.v.token });\n\t\t\tif (user) {\n\t\t\t\tRocketChat.models.Rooms.update({ _id: room._id }, {\n\t\t\t\t\t$set: {\n\t\t\t\t\t\tlabel: user.name || user.username,\n\t\t\t\t\t\t'v._id': user._id\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tRocketChat.models.Subscriptions.update({ rid: room._id }, {\n\t\t\t\t\t$set: {\n\t\t\t\t\t\tname: user.name || user.username\n\t\t\t\t\t}\n\t\t\t\t}, { multi: true });\n\t\t\t}\n\t\t});\n\t}\n});\n"]}