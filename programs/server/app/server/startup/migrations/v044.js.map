{"version":3,"sources":["meteor://ðŸ’»app/server/startup/migrations/v044.js"],"names":[],"mappings":";;;;;;;;AAAA,UAAU,CAAC,UAAU,CAAC,GAAG,CAAC;AACzB,QAAO,EAAE,EAAE;AACX,GAAE,EAAE,YAAW;AACd,MAAI,UAAU,IAAI,UAAU,CAAC,MAAM,IAAI,UAAU,CAAC,MAAM,CAAC,KAAK,EAAE;AAC/D,aAAU,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,GAAG,EAAE,CAAE,EAAE,iDAAiD,EAAE,EAAE,OAAO,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,oDAAoD,EAAE,EAAE,OAAO,EAAE,CAAC,EAAE,EAAE,CAAE,EAAE,CAAC,CAAC,OAAO,CAAC,UAAS,IAAI,EAAE;AACjN,QAAI,mBAAmB,GAAG,EAAE,IAAI,IAAI,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,0BAA0B,CAAC,CAAC;AACxI,QAAI,sBAAsB,GAAG,EAAE,IAAI,IAAI,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,IAAI,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,6BAA6B,CAAC,CAAC;AAC9I,cAAU,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,GAAG,EAAE,IAAI,CAAC,GAAG,EAAE,EAAE,EAAE,MAAM,EAAE,EAAE,iDAAiD,EAAE,CAAC,EAAE,oDAAoD,EAAE,CAAC,EAAE,EAAE,IAAI,EAAE,EAAE,0CAA0C,EAAE,mBAAmB,EAAE,6CAA6C,EAAE,sBAAsB,EAAE,EAAE,CAAC,CAAC;IACnU,CAAC,CAAC;GACH;;AAED,MAAI,UAAU,IAAI,UAAU,CAAC,MAAM,IAAI,UAAU,CAAC,MAAM,CAAC,QAAQ,EAAE;AAClE,OAAI,MAAM,GAAG,UAAU,CAAC,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE,GAAG,EAAE,oBAAoB,EAAE,CAAC,CAAC;AAC/E,OAAI,MAAM,EAAE;AACX,cAAU,CAAC,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,GAAG,EAAE,oBAAoB,EAAE,CAAC,CAAC;AACjE,cAAU,CAAC,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,GAAG,EAAE,sBAAsB,EAAE,EAAE;AAClE,SAAI,EAAE;AACL,WAAK,EAAE,CAAC,MAAM,CAAC,KAAK,GAAG,IAAI,GAAG,KAAK;AACnC,qBAAe,EAAE,kCAAkC;AACnD,kBAAY,EAAE,IAAI;AAClB,eAAS,EAAE,sBAAsB;MACjC;KACD,CAAC,CAAC;IACH;GACD;;AAED,MAAI,UAAU,IAAI,UAAU,CAAC,MAAM,IAAI,UAAU,CAAC,MAAM,CAAC,QAAQ,EAAE;AAClE,OAAI,aAAa,GAAG,UAAU,CAAC,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE,GAAG,EAAE,wBAAwB,EAAE,CAAC,CAAC;AAC1F,OAAI,aAAa,EAAE;AAClB,cAAU,CAAC,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,GAAG,EAAE,wBAAwB,EAAE,CAAC,CAAC;AACrE,cAAU,CAAC,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,GAAG,EAAE,gBAAgB,EAAE,EAAE;AAC5D,SAAI,EAAE;AACL,WAAK,EAAE,CAAC,aAAa,CAAC,KAAK,GAAG,IAAI,GAAG,KAAK;AAC1C,qBAAe,EAAE,4BAA4B;AAC7C,kBAAY,EAAE,IAAI;AAClB,eAAS,EAAE,gBAAgB;MAC3B;KACD,CAAC,CAAC;IACH;GACD;EACD;CACD,CAAC,CAAC,sE","file":"/server/startup/migrations/v044.js","sourcesContent":["RocketChat.Migrations.add({\n\tversion: 44,\n\tup: function() {\n\t\tif (RocketChat && RocketChat.models && RocketChat.models.Users) {\n\t\t\tRocketChat.models.Users.find({ $or: [ { 'settings.preferences.disableNewRoomNotification': { $exists: 1 } }, { 'settings.preferences.disableNewMessageNotification': { $exists: 1 } } ] }).forEach(function(user) {\n\t\t\t\tvar newRoomNotification = !(user && user.settings && user.settings.preferences && user.settings.preferences.disableNewRoomNotification);\n\t\t\t\tvar newMessageNotification = !(user && user.settings && user.settings.preferences && user.settings.preferences.disableNewMessageNotification);\n\t\t\t\tRocketChat.models.Users.update({ _id: user._id }, { $unset: { 'settings.preferences.disableNewRoomNotification': 1, 'settings.preferences.disableNewMessageNotification': 1 }, $set: { 'settings.preferences.newRoomNotification': newRoomNotification, 'settings.preferences.newMessageNotification': newMessageNotification } });\n\t\t\t});\n\t\t}\n\n\t\tif (RocketChat && RocketChat.models && RocketChat.models.Settings) {\n\t\t\tvar optOut = RocketChat.models.Settings.findOne({ _id: 'Statistics_opt_out' });\n\t\t\tif (optOut) {\n\t\t\t\tRocketChat.models.Settings.remove({ _id: 'Statistics_opt_out' });\n\t\t\t\tRocketChat.models.Settings.upsert({ _id: 'Statistics_reporting' }, {\n\t\t\t\t\t$set: {\n\t\t\t\t\t\tvalue: !optOut.value ? true : false,\n\t\t\t\t\t\ti18nDescription: 'Statistics_reporting_Description',\n\t\t\t\t\t\tpackageValue: true,\n\t\t\t\t\t\ti18nLabel: 'Statistics_reporting'\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (RocketChat && RocketChat.models && RocketChat.models.Settings) {\n\t\t\tvar favoriteRooms = RocketChat.models.Settings.findOne({ _id: 'Disable_Favorite_Rooms' });\n\t\t\tif (favoriteRooms) {\n\t\t\t\tRocketChat.models.Settings.remove({ _id: 'Disable_Favorite_Rooms' });\n\t\t\t\tRocketChat.models.Settings.upsert({ _id: 'Favorite_Rooms' }, {\n\t\t\t\t\t$set: {\n\t\t\t\t\t\tvalue: !favoriteRooms.value ? true : false,\n\t\t\t\t\t\ti18nDescription: 'Favorite_Rooms_Description',\n\t\t\t\t\t\tpackageValue: true,\n\t\t\t\t\t\ti18nLabel: 'Favorite_Rooms'\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n});\n"]}