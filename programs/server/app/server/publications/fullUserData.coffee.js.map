{"version":3,"sources":["meteor://ðŸ’»app/server/publications/fullUserData.coffee"],"names":[],"mappings":";;;;;;;;;AAAA,MAAM,CAAC,OAAP,CAAe,cAAf,EAA+B,SAAC,MAAD,EAAS,KAAT;AAC9B;AAAA,WAAQ,OAAR;AACC,WAAO,IAAC,MAAD,EAAP,CADD;GAAA;AAAA,EAGA,SACC;AAAA,UAAM,CAAN;AAAA,IACA,UAAU,CADV;AAAA,IAEA,QAAQ,CAFR;AAAA,IAGA,WAAW,CAHX;AAAA,IAIA,MAAM,CAJN;GAJD;AAUA,MAAG,UAAU,CAAC,KAAK,CAAC,aAAjB,CAAgC,IAAC,OAAjC,EAAyC,2BAAzC,MAAyE,IAA5E;AACC,aAAS,CAAC,CAAC,MAAF,CAAS,MAAT,EACR;AAAA,cAAQ,CAAR;AAAA,MACA,OAAO,CADP;AAAA,MAEA,kBAAkB,CAFlB;AAAA,MAGA,WAAW,CAHX;AAAA,MAIA,WAAW,CAJX;AAAA,MAKA,QAAQ,CALR;AAAA,MAMA,UAAU,CANV;AAAA,MAOA,uBAAuB,CAPvB;AAAA,MAQA,6BAA6B,CAR7B;AAAA,MASA,OAAO,CATP;KADQ,CAAT,CADD;GAAA;AAaC,YAAQ,CAAR,CAbD;GAVA;AAAA,EAyBA,SAAS,CAAC,CAAC,IAAF,CAAO,MAAP,CAzBT;AA2BA,MAAG,WAAe,UAAS,CAA3B;AACC,WAAO,IAAC,MAAD,EAAP,CADD;GA3BA;AAAA,EA8BA,UACC;AAAA,YAAQ,MAAR;AAAA,IACA,OAAO,KADP;AAAA,IAEA,MAAM;AAAA,MAAE,UAAU,CAAZ;KAFN;GA/BD;AAmCA,MAAG,MAAH;AACC,QAAG,UAAS,CAAZ;AACC,aAAO,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,cAAxB,CAAuC,MAAvC,EAA+C,OAA/C,CAAP,CADD;KAAA;AAGC,kBAAgB,WAAO,CAAC,CAAC,YAAF,CAAe,MAAf,CAAP,EAA+B,GAA/B,CAAhB;AACA,aAAO,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,gCAAxB,CAAyD,SAAzD,EAAoE,OAApE,CAAP,CAJD;KADD;GAnCA;AA0CA,SAAO,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,IAAxB,CAA6B,EAA7B,EAAiC,OAAjC,CAAP,CA3C8B;AAAA,CAA/B","file":"/server/publications/fullUserData.coffee.js","sourcesContent":["Meteor.publish 'fullUserData', (filter, limit) ->\n\tunless @userId\n\t\treturn @ready()\n\n\tfields =\n\t\tname: 1\n\t\tusername: 1\n\t\tstatus: 1\n\t\tutcOffset: 1\n\t\ttype: 1\n\n\tif RocketChat.authz.hasPermission( @userId, 'view-full-other-user-info') is true\n\t\tfields = _.extend fields,\n\t\t\temails: 1\n\t\t\tphone: 1\n\t\t\tstatusConnection: 1\n\t\t\tcreatedAt: 1\n\t\t\tlastLogin: 1\n\t\t\tactive: 1\n\t\t\tservices: 1\n\t\t\trequirePasswordChange: 1\n\t\t\trequirePasswordChangeReason: 1\n\t\t\troles: 1\n\telse\n\t\tlimit = 1\n\n\tfilter = s.trim filter\n\n\tif not filter and limit is 1\n\t\treturn @ready()\n\n\toptions =\n\t\tfields: fields\n\t\tlimit: limit\n\t\tsort: { username: 1 }\n\n\tif filter\n\t\tif limit is 1\n\t\t\treturn RocketChat.models.Users.findByUsername filter, options\n\t\telse\n\t\t\tfilterReg = new RegExp s.escapeRegExp(filter), \"i\"\n\t\t\treturn RocketChat.models.Users.findByUsernameNameOrEmailAddress filterReg, options\n\n\treturn RocketChat.models.Users.find {}, options\n"]}