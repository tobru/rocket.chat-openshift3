{"version":3,"sources":["meteor://ðŸ’»app/server/settings.js","meteor://ðŸ’»app/server/models/Rooms.js","meteor://ðŸ’»app/server/methods/jitsiSetTimeout.js","meteor://ðŸ’»app/server/actionLink.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAM,CAAC,OAAO,CAAC,YAAW;AACzB,WAAU,CAAC,QAAQ,CAAC,QAAQ,CAAC,kBAAkB,EAAE,YAAW;AAC3D,MAAI,CAAC,GAAG,CAAC,eAAe,EAAE,KAAK,EAAE;AAChC,OAAI,EAAE,SAAS;AACf,YAAS,EAAE,SAAS;AACpB,QAAK,EAAE,mGAAmG;AAC1G,aAAQ,IAAI;GACZ,CAAC,CAAC;;AAEH,MAAI,CAAC,GAAG,CAAC,cAAc,EAAE,aAAa,EAAE;AACvC,OAAI,EAAE,QAAQ;AACd,cAAW,EAAE;AACZ,OAAG,EAAE,eAAe;AACpB,SAAK,EAAE,IAAI;IACX;AACD,YAAS,EAAE,QAAQ;AACnB,aAAQ,IAAI;GACZ,CAAC,CAAC;;AAEH,MAAI,CAAC,GAAG,CAAC,WAAW,EAAE,IAAI,EAAE;AAC3B,OAAI,EAAE,SAAS;AACf,cAAW,EAAE;AACZ,OAAG,EAAE,eAAe;AACpB,SAAK,EAAE,IAAI;IACX;AACD,YAAS,EAAE,KAAK;AAChB,aAAQ,IAAI;GACZ,CAAC,CAAC;;AAEH,MAAI,CAAC,GAAG,CAAC,uBAAuB,EAAE,KAAK,EAAE;AACxC,OAAI,EAAE,SAAS;AACf,cAAW,EAAE;AACZ,OAAG,EAAE,eAAe;AACpB,SAAK,EAAE,IAAI;IACX;AACD,YAAS,EAAE,uBAAuB;AAClC,aAAQ,IAAI;GACZ,CAAC,CAAC;;AAEH,MAAI,CAAC,GAAG,CAAC,wBAAwB,EAAE,kCAAkC,EAAE;AACtE,OAAI,EAAE,QAAQ;AACd,cAAW,EAAE;AACZ,OAAG,EAAE,eAAe;AACpB,SAAK,EAAE,IAAI;IACX;AACD,YAAS,EAAE,wBAAwB;AACnC,aAAQ,IAAI;GACZ,CAAC,CAAC;EACH,CAAC,CAAC;CACH,CAAC,CAAC,gH;;;;;;;;;;;;;;;;;;;;;;;AC5CH,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,eAAe,GAAG,UAAS,GAAG,EAAE,IAAI,EAAE;AAC7D,KAAM,KAAK,GAAG;AACb,KAAG,EAAE,GAAG;EACR,CAAC;;AAEF,KAAM,MAAM,GAAG;AACd,MAAI,EAAE;AACL,eAAY,EAAE,IAAI;GAClB;EACD,CAAC;;AAEF,QAAO,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;CAClC,CAAC,iH;;;;;;;;;;;;;;;;;;;AChBF,MAAM,CAAC,OAAO,CAAC;AACd,sBAAqB,EAAE,UAAC,GAAG,EAAK;AAC/B,MAAI,IAAI,GAAG,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,EAAC,GAAG,EAAE,GAAG,EAAC,CAAC,CAAC;AACvD,MAAI,WAAW,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;;AAEvC,MAAI,YAAY,GAAG,IAAI,IAAI,CAAC,IAAI,CAAC,YAAY,IAAI,WAAW,CAAC,CAAC,OAAO,EAAE,CAAC;;AAExE,MAAI,YAAY,IAAI,WAAW,EAAE;AAChC,aAAU,CAAC,MAAM,CAAC,KAAK,CAAC,eAAe,CAAC,GAAG,EAAE,IAAI,IAAI,CAAC,WAAW,GAAG,EAAE,GAAC,IAAI,CAAC,CAAC,CAAC;AAC9E,aAAU,CAAC,MAAM,CAAC,QAAQ,CAAC,kCAAkC,CAAC,oBAAoB,EAAE,GAAG,EAAE,EAAE,EAAE,MAAM,CAAC,IAAI,EAAE,EAAE;AAC3G,eAAW,EAAG,CACb,EAAE,IAAI,EAAE,eAAe,EAAE,KAAK,EAAE,gBAAgB,EAAE,SAAS,EAAE,eAAe,EAAE,MAAM,EAAE,EAAE,EAAC,CACzF;IACD,CAAC,CAAC;GACH,MAAM,IAAI,CAAC,YAAY,GAAG,WAAW,IAAI,IAAI,IAAI,EAAE,EAAE;AACrD,aAAU,CAAC,MAAM,CAAC,KAAK,CAAC,eAAe,CAAC,GAAG,EAAE,IAAI,IAAI,CAAC,YAAY,GAAG,EAAE,GAAC,IAAI,CAAC,CAAC,CAAC;GAC/E;EACD;CACD,CAAC,CAAC,gH;;;;;;;;;;;;;;;;;;ACnBH,UAAU,CAAC,WAAW,CAAC,QAAQ,CAAC,eAAe,EAAE,+BAA8B,EAE9E,CAAC,CAAC,iC","file":"/packages/rocketchat_videobridge.js","sourcesContent":["Meteor.startup(function() {\n\tRocketChat.settings.addGroup('Video Conference', function() {\n\t\tthis.add('Jitsi_Enabled', false, {\n\t\t\ttype: 'boolean',\n\t\t\ti18nLabel: 'Enabled',\n\t\t\talert: 'This Feature is currently in beta! Please report bugs to github.com/RocketChat/Rocket.Chat/issues',\n\t\t\tpublic: true\n\t\t});\n\n\t\tthis.add('Jitsi_Domain', 'meet.jit.si', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Jitsi_Enabled',\n\t\t\t\tvalue: true\n\t\t\t},\n\t\t\ti18nLabel: 'Domain',\n\t\t\tpublic: true\n\t\t});\n\n\t\tthis.add('Jitsi_SSL', true, {\n\t\t\ttype: 'boolean',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Jitsi_Enabled',\n\t\t\t\tvalue: true\n\t\t\t},\n\t\t\ti18nLabel: 'SSL',\n\t\t\tpublic: true\n\t\t});\n\n\t\tthis.add('Jitsi_Enable_Channels', false, {\n\t\t\ttype: 'boolean',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Jitsi_Enabled',\n\t\t\t\tvalue: true\n\t\t\t},\n\t\t\ti18nLabel: 'Jitsi_Enable_Channels',\n\t\t\tpublic: true\n\t\t});\n\n\t\tthis.add('Jitsi_Chrome_Extension', 'nocfbnnmjnndkbipkabodnheejiegccf', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Jitsi_Enabled',\n\t\t\t\tvalue: true\n\t\t\t},\n\t\t\ti18nLabel: 'Jitsi_Chrome_Extension',\n\t\t\tpublic: true\n\t\t});\n\t});\n});\n","/**\n * sets jitsiTimeout to indicate a call is in progress\n * @param {string} _id - Room id\n * @parm {number} time - time to set\n */\nRocketChat.models.Rooms.setJitsiTimeout = function(_id, time) {\n\tconst query = {\n\t\t_id: _id\n\t};\n\n\tconst update = {\n\t\t$set: {\n\t\t\tjitsiTimeout: time\n\t\t}\n\t};\n\n\treturn this.update(query, update);\n};\n","\nMeteor.methods({\n\t'jitsi:updateTimeout': (rid) => {\n\t\tlet room = RocketChat.models.Rooms.findOne({_id: rid});\n\t\tlet currentTime = new Date().getTime();\n\n\t\tlet jitsiTimeout = new Date(room.jitsiTimeout || currentTime).getTime();\n\n\t\tif (jitsiTimeout <= currentTime) {\n\t\t\tRocketChat.models.Rooms.setJitsiTimeout(rid, new Date(currentTime + 35*1000));\n\t\t\tRocketChat.models.Messages.createWithTypeRoomIdMessageAndUser('jitsi_call_started', rid, '', Meteor.user(), {\n\t\t\t\tactionLinks : [\n\t\t\t\t\t{ icon: 'icon-videocam', label: 'Click To Join!', method_id: 'joinJitsiCall', params: ''}\n\t\t\t\t]\n\t\t\t});\n\t\t} else if ((jitsiTimeout - currentTime) / 1000 <= 15) {\n\t\t\tRocketChat.models.Rooms.setJitsiTimeout(rid, new Date(jitsiTimeout + 25*1000));\n\t\t}\n\t}\n});\n","RocketChat.actionLinks.register('joinJitsiCall', function(/*message, params*/) {\n\n});\n"]}