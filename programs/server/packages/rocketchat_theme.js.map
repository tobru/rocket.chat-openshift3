{"version":3,"sources":["meteor://ðŸ’»app/packages/rocketchat_theme/server/server.coffee","meteor://ðŸ’»app/packages/rocketchat_theme/server/variables.coffee"],"names":[],"mappings":"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","file":"/packages/rocketchat_theme.js","sourcesContent":["less = Npm.require('less')\nautoprefixer = Npm.require('less-plugin-autoprefix')\ncrypto = Npm.require('crypto')\n\nlogger = new Logger 'rocketchat:theme',\n\tmethods:\n\t\tstop_rendering:\n\t\t\ttype: 'info'\n\n\ncalculateClientHash = WebAppHashing.calculateClientHash\nWebAppHashing.calculateClientHash = (manifest, includeFilter, runtimeConfigOverride) ->\n\tcss = RocketChat.theme.getCss()\n\n\tWebAppInternals.staticFiles['/__cordova/theme.css'] = WebAppInternals.staticFiles['/theme.css'] =\n\t\tcacheable: true\n\t\tsourceMapUrl: undefined\n\t\ttype: 'css'\n\t\tcontent: css\n\n\thash = crypto.createHash('sha1').update(css).digest('hex')\n\n\tthemeManifestItem = _.find manifest, (item) -> return item.path is 'app/theme.css'\n\tif not themeManifestItem?\n\t\tthemeManifestItem = {}\n\t\tmanifest.push themeManifestItem\n\n\tthemeManifestItem.path = 'app/theme.css'\n\tthemeManifestItem.type = 'css'\n\tthemeManifestItem.cacheable = true\n\tthemeManifestItem.where = 'client'\n\tthemeManifestItem.url = \"/theme.css?#{hash}\"\n\tthemeManifestItem.size = css.length\n\tthemeManifestItem.hash = hash\n\n\tcalculateClientHash.call this, manifest, includeFilter, runtimeConfigOverride\n\n\nRocketChat.theme = new class\n\tvariables: {}\n\tpackageCallbacks: []\n\tfiles: [\n\t\t'assets/stylesheets/global/_variables.less'\n\t\t'assets/stylesheets/utils/_keyframes.import.less'\n\t\t'assets/stylesheets/utils/_lesshat.import.less'\n\t\t'assets/stylesheets/utils/_preloader.import.less'\n\t\t'assets/stylesheets/utils/_reset.import.less'\n\t\t'assets/stylesheets/utils/_chatops.less'\n\t\t'assets/stylesheets/animation.css'\n\t\t'assets/stylesheets/base.less'\n\t\t'assets/stylesheets/fontello.css'\n\t\t'assets/stylesheets/rtl.less'\n\t\t'assets/stylesheets/swipebox.min.css'\n\t\t'assets/stylesheets/utils/_colors.import.less'\n\t]\n\n\tconstructor: ->\n\t\t@customCSS = ''\n\n\t\tRocketChat.settings.add 'css', ''\n\t\tRocketChat.settings.addGroup 'Layout'\n\n\t\t@compileDelayed = _.debounce Meteor.bindEnvironment(@compile.bind(@)), 300\n\n\t\tRocketChat.settings.onload '*', Meteor.bindEnvironment (key, value, initialLoad) =>\n\t\t\tif key is 'theme-custom-css'\n\t\t\t\tif value?.trim() isnt ''\n\t\t\t\t\t@customCSS = value\n\t\t\telse if /^theme-.+/.test(key) is true\n\t\t\t\tname = key.replace /^theme-[a-z]+-/, ''\n\t\t\t\tif @variables[name]?\n\t\t\t\t\t@variables[name].value = value\n\t\t\telse\n\t\t\t\treturn\n\n\t\t\t@compileDelayed()\n\n\tcompile: ->\n\t\tcontent = [\n\t\t\t@getVariablesAsLess()\n\t\t]\n\n\t\tcontent.push Assets.getText file for file in @files\n\n\t\tfor packageCallback in @packageCallbacks\n\t\t\tresult = packageCallback()\n\t\t\tif _.isString result\n\t\t\t\tcontent.push result\n\n\t\tcontent.push @customCSS\n\n\t\tcontent = content.join '\\n'\n\n\t\toptions =\n\t\t\tcompress: true\n\t\t\tplugins: [\n\t\t\t\tnew autoprefixer()\n\t\t\t]\n\n\t\tstart = Date.now()\n\t\tless.render content, options, (err, data) ->\n\t\t\tlogger.stop_rendering Date.now() - start\n\t\t\tif err?\n\t\t\t\treturn console.log err\n\n\t\t\tRocketChat.settings.updateById 'css', data.css\n\n\t\t\tprocess.emit('message', {refresh: 'client'})\n\n\taddVariable: (type, name, value, persist=true) ->\n\t\t@variables[name] =\n\t\t\ttype: type\n\t\t\tvalue: value\n\n\t\tif persist is true\n\t\t\tconfig =\n\t\t\t\tgroup: 'Layout'\n\t\t\t\ttype: type\n\t\t\t\tsection: 'Colors'\n\t\t\t\tpublic: false\n\n\t\t\tRocketChat.settings.add \"theme-#{type}-#{name}\", value, config\n\n\taddPublicColor: (name, value) ->\n\t\t@addVariable 'color', name, value, true\n\n\tgetVariablesAsObject: ->\n\t\tobj = {}\n\t\tfor name, variable of @variables\n\t\t\tobj[name] = variable.value\n\n\t\treturn obj\n\n\tgetVariablesAsLess: ->\n\t\titems = []\n\t\tfor name, variable of @variables\n\t\t\titems.push \"@#{name}: #{variable.value};\"\n\n\t\treturn items.join '\\n'\n\n\taddPackageAsset: (cb) ->\n\t\t@packageCallbacks.push cb\n\t\t@compileDelayed()\n\n\tgetCss: ->\n\t\treturn RocketChat.settings.get 'css'\n","RocketChat.theme.addPublicColor \"primary-background-color\", \"#04436a\"\nRocketChat.theme.addPublicColor \"primary-font-color\", \"#444444\"\nRocketChat.theme.addPublicColor \"secondary-background-color\", \"#f4f4f4\"\nRocketChat.theme.addPublicColor \"secondary-font-color\", \"#7f7f7f\"\nRocketChat.theme.addPublicColor \"tertiary-background-color\", \"#eaeaea\"\nRocketChat.theme.addPublicColor \"tertiary-font-color\", \"rgba(255, 255, 255, 0.6)\"\nRocketChat.theme.addPublicColor \"quaternary-font-color\", \"#ffffff\"\n\nRocketChat.theme.addPublicColor \"action-buttons-color\", \"#13679a\"\nRocketChat.theme.addPublicColor \"active-channel-background-color\", \"rgba(255, 255, 255, 0.075)\"\nRocketChat.theme.addPublicColor \"active-channel-font-color\", \"rgba(255, 255, 255, 0.75)\"\nRocketChat.theme.addPublicColor \"blockquote-background\", \"#cccccc\"\nRocketChat.theme.addPublicColor \"clean-buttons-color\", \"rgba(0, 0, 0, 0.25)\"\nRocketChat.theme.addPublicColor \"code-background\", \"#f8f8f8\"\nRocketChat.theme.addPublicColor \"code-border\", \"#cccccc\"\nRocketChat.theme.addPublicColor \"code-color\", \"#333333\"\nRocketChat.theme.addPublicColor \"content-background-color\", \"#ffffff\"\nRocketChat.theme.addPublicColor \"custom-scrollbar-color\", \"rgba(255, 255, 255, 0.05)\"\nRocketChat.theme.addPublicColor \"info-active-font-color\", \"#ff0000\"\nRocketChat.theme.addPublicColor \"info-font-color\", \"#aaaaaa\"\nRocketChat.theme.addPublicColor \"input-font-color\", \"rgba(255, 255, 255, 0.85)\"\nRocketChat.theme.addPublicColor \"link-font-color\", \"#008ce3\"\nRocketChat.theme.addPublicColor \"message-hover-background-color\", \"rgba(0, 0, 0, 0.025)\"\nRocketChat.theme.addPublicColor \"smallprint-font-color\", \"#c2e7ff\"\nRocketChat.theme.addPublicColor \"smallprint-hover-color\", \"#ffffff\"\nRocketChat.theme.addPublicColor \"status-away\", \"#fcb316\"\nRocketChat.theme.addPublicColor \"status-busy\", \"#d30230\"\nRocketChat.theme.addPublicColor \"status-offline\", \"rgba(150, 150, 150, 0.50)\"\nRocketChat.theme.addPublicColor \"status-online\", \"#35ac19\"\nRocketChat.theme.addPublicColor \"unread-notification-color\", \"#1dce73\"\n\n\nRocketChat.settings.add \"theme-custom-css\", '',\n\tgroup: 'Layout'\n\ttype: 'code'\n\tcode: 'text/x-less'\n\tmultiline: true\n\tsection: 'Custom CSS'\n\tpublic: false\n"]}