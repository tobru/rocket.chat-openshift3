{"version":3,"sources":["meteor://ðŸ’»app/settings.js","meteor://ðŸ’»app/SMS.js","meteor://ðŸ’»app/services/twilio.js"],"names":[],"mappings":"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","file":"/packages/rocketchat_sms.js","sourcesContent":["Meteor.startup(function() {\n\tRocketChat.settings.addGroup('SMS', function() {\n\t\tthis.add('SMS_Enabled', false, {\n\t\t\ttype: 'boolean',\n\t\t\ti18nLabel: 'Enabled'\n\t\t});\n\n\t\tthis.add('SMS_Service', 'twilio', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [{\n\t\t\t\tkey: 'twilio',\n\t\t\t\ti18nLabel: 'Twilio'\n\t\t\t}],\n\t\t\ti18nLabel: 'Service'\n\t\t});\n\n\t\tthis.section('Twilio', function() {\n\t\t\tthis.add('SMS_Twilio_Account_SID', '', {\n\t\t\t\ttype: 'string',\n\t\t\t\tenableQuery: {\n\t\t\t\t\t_id: 'SMS_Service',\n\t\t\t\t\tvalue: 'twilio'\n\t\t\t\t},\n\t\t\t\ti18nLabel: 'Account_SID'\n\t\t\t});\n\t\t\tthis.add('SMS_Twilio_authToken', '', {\n\t\t\t\ttype: 'string',\n\t\t\t\tenableQuery: {\n\t\t\t\t\t_id: 'SMS_Service',\n\t\t\t\t\tvalue: 'twilio'\n\t\t\t\t},\n\t\t\t\ti18nLabel: 'Auth_Token'\n\t\t\t});\n\t\t});\n\t});\n});\n","/* globals RocketChat */\nRocketChat.SMS = {\n\tenabled: false,\n\tservices: {},\n\taccountSid: null,\n\tauthToken: null,\n\tfromNumber: null,\n\n\tregisterService(name, service) {\n\t\tthis.services[name] = service;\n\t},\n\n\tgetService(name) {\n\t\tif (!this.services[name]) {\n\t\t\tthrow new Meteor.Error('error-sms-service-not-configured');\n\t\t}\n\t\treturn new this.services[name](this.accountSid, this.authToken, this.fromNumber);\n\t}\n};\n\nRocketChat.settings.get('SMS_Enabled', function(key, value) {\n\tRocketChat.SMS.enabled = value;\n});\n","/* globals RocketChat */\nclass Twilio {\n\tconstructor() {\n\t\tthis.accountSid = RocketChat.settings.get('SMS_Twilio_Account_SID');\n\t\tthis.authToken = RocketChat.settings.get('SMS_Twilio_authToken');\n\t}\n\tparse(data) {\n\t\treturn {\n\t\t\tfrom: data.From,\n\t\t\tto: data.To,\n\t\t\tbody: data.Body,\n\n\t\t\textra: {\n\t\t\t\ttoCountry: data.ToCountry,\n\t\t\t\ttoState: data.ToState,\n\t\t\t\ttoCity: data.ToCity,\n\t\t\t\ttoZip: data.ToZip,\n\t\t\t\tfromCountry: data.FromCountry,\n\t\t\t\tfromState: data.FromState,\n\t\t\t\tfromCity: data.FromCity,\n\t\t\t\tfromZip: data.FromZip\n\t\t\t}\n\t\t};\n\t}\n\tsend(fromNumber, toNumber, message) {\n\t\tvar client = Npm.require('twilio')(this.accountSid, this.authToken);\n\n\t\tclient.messages.create({\n\t\t\tto: toNumber,\n\t\t\tfrom: fromNumber,\n\t\t\tbody: message\n\t\t});\n\t}\n\tresponse(/* message */) {\n\t\treturn {\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'text/xml'\n\t\t\t},\n\t\t\tbody: '<Response></Response>'\n\t\t};\n\t}\n\terror(error) {\n\t\tlet message = '';\n\t\tif (error.reason) {\n\t\t\tmessage = `<Message>${error.reason}</Message>`;\n\t\t}\n\t\treturn {\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'text/xml'\n\t\t\t},\n\t\t\tbody: `<Response>${message}</Response>`\n\t\t};\n\t}\n}\n\nRocketChat.SMS.registerService('twilio', Twilio);\n"]}