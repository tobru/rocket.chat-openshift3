{"version":3,"sources":["meteor://ðŸ’»app/livechat.js","meteor://ðŸ’»app/server/startup.js","meteor://ðŸ’»app/permissions.js","meteor://ðŸ’»app/config.js","meteor://ðŸ’»app/lib/ua-parser.js","meteor://ðŸ’»app/client/stylesheets/load.js","meteor://ðŸ’»app/server/hooks/markRoomResponded.js","meteor://ðŸ’»app/server/methods/addAgent.js","meteor://ðŸ’»app/server/methods/addManager.js","meteor://ðŸ’»app/server/methods/changeLivechatStatus.js","meteor://ðŸ’»app/server/methods/closeRoom.js","meteor://ðŸ’»app/server/methods/getCustomFields.js","meteor://ðŸ’»app/server/methods/getInitialData.js","meteor://ðŸ’»app/server/methods/pageVisited.js","meteor://ðŸ’»app/server/methods/registerGuest.js","meteor://ðŸ’»app/server/methods/removeAgent.js","meteor://ðŸ’»app/server/methods/removeCustomField.js","meteor://ðŸ’»app/server/methods/removeDepartment.js","meteor://ðŸ’»app/server/methods/removeManager.js","meteor://ðŸ’»app/server/methods/removeTrigger.js","meteor://ðŸ’»app/server/methods/saveCustomField.js","meteor://ðŸ’»app/server/methods/saveDepartment.js","meteor://ðŸ’»app/server/methods/saveIntegration.js","meteor://ðŸ’»app/server/methods/saveLivechatInfo.js","meteor://ðŸ’»app/server/methods/saveSurveyFeedback.js","meteor://ðŸ’»app/server/methods/saveTrigger.js","meteor://ðŸ’»app/server/methods/searchAgent.js","meteor://ðŸ’»app/server/methods/sendMessageLivechat.js","meteor://ðŸ’»app/server/methods/sendOfflineMessage.js","meteor://ðŸ’»app/server/methods/setCustomField.js","meteor://ðŸ’»app/server/methods/transfer.js","meteor://ðŸ’»app/server/methods/webhookTest.js","meteor://ðŸ’»app/server/methods/takeInquiry.js","meteor://ðŸ’»app/server/methods/returnAsInquiry.js","meteor://ðŸ’»app/server/models/Users.js","meteor://ðŸ’»app/server/models/Rooms.js","meteor://ðŸ’»app/server/models/LivechatExternalMessage.js","meteor://ðŸ’»app/server/models/LivechatCustomField.js","meteor://ðŸ’»app/server/models/LivechatDepartment.js","meteor://ðŸ’»app/server/models/LivechatDepartmentAgents.js","meteor://ðŸ’»app/server/models/LivechatPageVisited.js","meteor://ðŸ’»app/server/models/LivechatTrigger.js","meteor://ðŸ’»app/server/models/indexes.js","meteor://ðŸ’»app/server/models/LivechatInquiry.js","meteor://ðŸ’»app/server/lib/Livechat.js","meteor://ðŸ’»app/server/lib/QueueMethods.js","meteor://ðŸ’»app/server/sendMessageBySMS.js","meteor://ðŸ’»app/server/externalMessageHook.js","meteor://ðŸ’»app/server/forwardUnclosedLivechats.js","meteor://ðŸ’»app/server/setupWebhook.js","meteor://ðŸ’»app/server/publications/customFields.js","meteor://ðŸ’»app/server/publications/departmentAgents.js","meteor://ðŸ’»app/server/publications/externalMessages.js","meteor://ðŸ’»app/server/publications/livechatAgents.js","meteor://ðŸ’»app/server/publications/livechatDepartments.js","meteor://ðŸ’»app/server/publications/livechatIntegration.js","meteor://ðŸ’»app/server/publications/livechatManagers.js","meteor://ðŸ’»app/server/publications/livechatRooms.js","meteor://ðŸ’»app/server/publications/livechatQueue.js","meteor://ðŸ’»app/server/publications/visitorHistory.js","meteor://ðŸ’»app/server/publications/visitorInfo.js","meteor://ðŸ’»app/server/publications/visitorPageVisited.js","meteor://ðŸ’»app/server/publications/livechatInquiries.js","meteor://ðŸ’»app/server/api.js"],"names":[],"mappings":"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","file":"/packages/rocketchat_livechat.js","sourcesContent":["/* globals WebApp:true */\n\nWebApp = Package.webapp.WebApp;\nconst Autoupdate = Package.autoupdate.Autoupdate;\n\nWebApp.connectHandlers.use('/livechat/', (req, res/*, next*/) => {\n\tres.setHeader('content-type', 'text/html; charset=utf-8');\n\n\tconst head = Assets.getText('public/head.html');\n\n\tconst html = `<html>\n\t\t<head>\n\t\t\t<link rel=\"stylesheet\" type=\"text/css\" class=\"__meteor-css__\" href=\"/packages/rocketchat_livechat/public/livechat.css?_dc=${Autoupdate.autoupdateVersion}\">\n\t\t\t<script type=\"text/javascript\">\n\t\t\t\t__meteor_runtime_config__ = ${JSON.stringify(__meteor_runtime_config__)};\n\t\t\t</script>\n\t\t\t<script type=\"text/javascript\" src=\"/packages/rocketchat_livechat/public/livechat.js?_dc=${Autoupdate.autoupdateVersion}\"></script>\n\n\t\t\t${head}\n\t\t</head>\n\t\t<body>\n\t\t</body>\n\t</html>`;\n\n\tres.write(html);\n\tres.end();\n});\n","Meteor.startup(() => {\n\tRocketChat.roomTypes.setPublish('l', (code) => {\n\t\treturn RocketChat.models.Rooms.findLivechatByCode(code, {\n\t\t\tname: 1,\n\t\t\tt: 1,\n\t\t\tcl: 1,\n\t\t\tu: 1,\n\t\t\tlabel: 1,\n\t\t\tusernames: 1,\n\t\t\tv: 1,\n\t\t\tlivechatData: 1,\n\t\t\ttopic: 1,\n\t\t\ttags: 1,\n\t\t\tsms: 1,\n\t\t\tcode: 1,\n\t\t\topen: 1\n\t\t});\n\t});\n\n\tRocketChat.authz.addRoomAccessValidator(function(room, user) {\n\t\treturn room.t === 'l' && RocketChat.authz.hasPermission(user._id, 'view-livechat-rooms');\n\t});\n\n\tRocketChat.callbacks.add('beforeLeaveRoom', function(user, room) {\n\t\tif (room.t !== 'l') {\n\t\t\treturn user;\n\t\t}\n\t\tthrow new Meteor.Error(TAPi18n.__('You_cant_leave_a_livechat_room_Please_use_the_close_button', {\n\t\t\tlng: user.language || RocketChat.settings.get('language') || 'en'\n\t\t}));\n\t}, RocketChat.callbacks.priority.LOW);\n});\n","Meteor.startup(() => {\n\tvar roles = _.pluck(RocketChat.models.Roles.find().fetch(), 'name');\n\tif (roles.indexOf('livechat-agent') === -1) {\n\t\tRocketChat.models.Roles.createOrUpdate('livechat-agent');\n\t}\n\tif (roles.indexOf('livechat-manager') === -1) {\n\t\tRocketChat.models.Roles.createOrUpdate('livechat-manager');\n\t}\n\tif (roles.indexOf('livechat-guest') === -1) {\n\t\tRocketChat.models.Roles.createOrUpdate('livechat-guest');\n\t}\n\tif (RocketChat.models && RocketChat.models.Permissions) {\n\t\tRocketChat.models.Permissions.createOrUpdate('view-l-room', ['livechat-agent', 'livechat-manager', 'admin']);\n\t\tRocketChat.models.Permissions.createOrUpdate('view-livechat-manager', ['livechat-manager', 'admin']);\n\t\tRocketChat.models.Permissions.createOrUpdate('view-livechat-rooms', ['livechat-manager', 'admin']);\n\t\tRocketChat.models.Permissions.createOrUpdate('close-livechat-room', ['livechat-agent', 'livechat-manager', 'admin']);\n\t\tRocketChat.models.Permissions.createOrUpdate('close-others-livechat-room', ['livechat-manager', 'admin']);\n\t}\n});\n","Meteor.startup(function() {\n\tRocketChat.settings.addGroup('Livechat');\n\n\tRocketChat.settings.add('Livechat_enabled', false, { type: 'boolean', group: 'Livechat', public: true });\n\n\tRocketChat.settings.add('Livechat_title', 'Rocket.Chat', { type: 'string', group: 'Livechat', public: true });\n\tRocketChat.settings.add('Livechat_title_color', '#C1272D', { type: 'color', group: 'Livechat', public: true });\n\n\tRocketChat.settings.add('Livechat_display_offline_form', true, {\n\t\ttype: 'boolean',\n\t\tgroup: 'Livechat',\n\t\tpublic: true,\n\t\tsection: 'Offline',\n\t\ti18nLabel: 'Display_offline_form'\n\t});\n\n\tRocketChat.settings.add('Livechat_offline_form_unavailable', '', {\n\t\ttype: 'string',\n\t\tgroup: 'Livechat',\n\t\tpublic: true,\n\t\tsection: 'Offline',\n\t\ti18nLabel: 'Offline_form_unavailable_message'\n\t});\n\n\tRocketChat.settings.add('Livechat_offline_title', 'Leave a message', {\n\t\ttype: 'string',\n\t\tgroup: 'Livechat',\n\t\tpublic: true,\n\t\tsection: 'Offline',\n\t\ti18nLabel: 'Title'\n\t});\n\tRocketChat.settings.add('Livechat_offline_title_color', '#666666', {\n\t\ttype: 'color',\n\t\tgroup: 'Livechat',\n\t\tpublic: true,\n\t\tsection: 'Offline',\n\t\ti18nLabel: 'Color'\n\t});\n\tRocketChat.settings.add('Livechat_offline_message', 'We are not online right now. Please leave us a message:', {\n\t\ttype: 'string',\n\t\tgroup: 'Livechat',\n\t\tpublic: true,\n\t\tsection: 'Offline',\n\t\ti18nLabel: 'Instructions',\n\t\ti18nDescription: 'Instructions_to_your_visitor_fill_the_form_to_send_a_message'\n\t});\n\tRocketChat.settings.add('Livechat_offline_email', '', {\n\t\ttype: 'string',\n\t\tgroup: 'Livechat',\n\t\ti18nLabel: 'Email_address_to_send_offline_messages',\n\t\tsection: 'Offline'\n\t});\n\tRocketChat.settings.add('Livechat_offline_success_message', '', {\n\t\ttype: 'string',\n\t\tgroup: 'Livechat',\n\t\tpublic: true,\n\t\tsection: 'Offline',\n\t\ti18nLabel: 'Offline_success_message'\n\t});\n\n\tRocketChat.settings.add('Livechat_registration_form', true, { type: 'boolean', group: 'Livechat', public: true, i18nLabel: 'Show_preregistration_form' });\n\tRocketChat.settings.add('Livechat_guest_count', 1, { type: 'int', group: 'Livechat' });\n\n\tRocketChat.settings.add('Livechat_Room_Count', 1, {\n\t\ttype: 'int',\n\t\tgroup: 'Livechat',\n\t\ti18nLabel: 'Livechat_room_count'\n\t});\n\n\tRocketChat.settings.add('Livechat_forward_open_chats', false, {\n\t\ttype: 'boolean',\n\t\tgroup: 'Livechat'\n\t});\n\n\tRocketChat.settings.add('Livechat_forward_open_chats_timeout', 60, {\n\t\ttype: 'int',\n\t\tgroup: 'Livechat',\n\t\tenableQuery: { _id: 'Livechat_forward_open_chats', value: true }\n\t});\n\n\tRocketChat.settings.add('Livechat_webhookUrl', false, {\n\t\ttype: 'string',\n\t\tgroup: 'Livechat',\n\t\tsection: 'CRM Integration',\n\t\ti18nLabel: 'Webhook_URL'\n\t});\n\n\tRocketChat.settings.add('Livechat_secret_token', false, {\n\t\ttype: 'string',\n\t\tgroup: 'Livechat',\n\t\tsection: 'CRM Integration',\n\t\ti18nLabel: 'Secret_token'\n\t});\n\n\tRocketChat.settings.add('Livechat_webhook_on_close', false, {\n\t\ttype: 'boolean',\n\t\tgroup: 'Livechat',\n\t\tsection: 'CRM Integration',\n\t\ti18nLabel: 'Send_request_on_chat_close'\n\t});\n\n\tRocketChat.settings.add('Livechat_webhook_on_offline_msg', false, {\n\t\ttype: 'boolean',\n\t\tgroup: 'Livechat',\n\t\tsection: 'CRM Integration',\n\t\ti18nLabel: 'Send_request_on_offline_messages'\n\t});\n\n\tRocketChat.settings.add('Livechat_Knowledge_Enabled', false, {\n\t\ttype: 'boolean',\n\t\tgroup: 'Livechat',\n\t\tsection: 'Knowledge Base',\n\t\tpublic: true,\n\t\ti18nLabel: 'Enabled'\n\t});\n\n\tRocketChat.settings.add('Livechat_Knowledge_Apiai_Key', '', {\n\t\ttype: 'string',\n\t\tgroup: 'Livechat',\n\t\tsection: 'Knowledge Base',\n\t\tpublic: true,\n\t\ti18nLabel: 'Apiai_Key'\n\t});\n\n\tRocketChat.settings.add('Livechat_Knowledge_Apiai_Language', 'en', {\n\t\ttype: 'string',\n\t\tgroup: 'Livechat',\n\t\tsection: 'Knowledge Base',\n\t\tpublic: true,\n\t\ti18nLabel: 'Apiai_Language'\n\t});\n\n\tRocketChat.settings.add('Livechat_history_monitor_type', 'url', {\n\t\ttype: 'select',\n\t\tgroup: 'Livechat',\n\t\ti18nLabel: 'Monitor_history_for_changes_on',\n\t\tvalues: [\n\t\t\t{ key: 'url', i18nLabel: 'Page_URL' },\n\t\t\t{ key: 'title', i18nLabel: 'Page_title' }\n\t\t]\n\t});\n\n\tRocketChat.settings.add('Livechat_Routing_Method', 'Least_Amount', {\n\t\ttype: 'select',\n\t\tgroup: 'Livechat',\n\t\tpublic: true,\n\t\tvalues: [\n\t\t\t{key: 'Least_Amount', i18nLabel: 'Least_Amount'},\n\t\t\t{key: 'Guest_Pool', i18nLabel: 'Guest_Pool'}\n\t\t]\n\t});\n\n\tRocketChat.settings.add('Livechat_guest_pool_with_no_agents', false, {\n\t\ttype: 'boolean',\n\t\tgroup: 'Livechat',\n\t\ti18nLabel: 'Accept_with_no_online_agents',\n\t\ti18nDescription: 'Accept_incoming_livechat_requests_even_if_there_are_no_online_agents',\n\t\tenableQuery: { _id: 'Livechat_Routing_Method', value: 'Guest_Pool' }\n\t});\n\n\tRocketChat.settings.add('Livechat_show_queue_list_link', false, {\n\t\ttype: 'boolean',\n\t\tgroup: 'Livechat',\n\t\tpublic: true,\n\t\ti18nLabel: 'Show_queue_list_to_all_agents'\n\t});\n});\n","/**\n * UAParser.js v0.7.10\n * Lightweight JavaScript-based User-Agent string parser\n * https://github.com/faisalman/ua-parser-js\n *\n * Copyright Â© 2012-2015 Faisal Salman <fyzlman@gmail.com>\n * Dual licensed under GPLv2 & MIT\n */(function(e,t){\"use strict\";var n=\"0.7.10\",r=\"\",i=\"?\",s=\"function\",o=\"undefined\",u=\"object\",a=\"string\",f=\"major\",l=\"model\",c=\"name\",h=\"type\",p=\"vendor\",d=\"version\",v=\"architecture\",m=\"console\",g=\"mobile\",y=\"tablet\",b=\"smarttv\",w=\"wearable\",E=\"embedded\",S={extend:function(e,t){for(var n in t)\"browser cpu device engine os\".indexOf(n)!==-1&&t[n].length%2===0&&(e[n]=t[n].concat(e[n]));return e},has:function(e,t){return typeof e==\"string\"?t.toLowerCase().indexOf(e.toLowerCase())!==-1:!1},lowerize:function(e){return e.toLowerCase()},major:function(e){return typeof e===a?e.split(\".\")[0]:t}},x={rgx:function(){var e,n=0,r,i,a,f,l,c,h=arguments;while(n<h.length&&!l){var p=h[n],d=h[n+1];if(typeof e===o){e={};for(a in d)d.hasOwnProperty(a)&&(f=d[a],typeof f===u?e[f[0]]=t:e[f]=t)}r=i=0;while(r<p.length&&!l){l=p[r++].exec(this.getUA());if(!!l)for(a=0;a<d.length;a++)c=l[++i],f=d[a],typeof f===u&&f.length>0?f.length==2?typeof f[1]==s?e[f[0]]=f[1].call(this,c):e[f[0]]=f[1]:f.length==3?typeof f[1]===s&&(!f[1].exec||!f[1].test)?e[f[0]]=c?f[1].call(this,c,f[2]):t:e[f[0]]=c?c.replace(f[1],f[2]):t:f.length==4&&(e[f[0]]=c?f[3].call(this,c.replace(f[1],f[2])):t):e[f]=c?c:t}n+=2}return e},str:function(e,n){for(var r in n)if(typeof n[r]===u&&n[r].length>0){for(var s=0;s<n[r].length;s++)if(S.has(n[r][s],e))return r===i?t:r}else if(S.has(n[r],e))return r===i?t:r;return e}},T={browser:{oldsafari:{version:{\"1.0\":\"/8\",1.2:\"/1\",1.3:\"/3\",\"2.0\":\"/412\",\"2.0.2\":\"/416\",\"2.0.3\":\"/417\",\"2.0.4\":\"/419\",\"?\":\"/\"}}},device:{amazon:{model:{\"Fire Phone\":[\"SD\",\"KF\"]}},sprint:{model:{\"Evo Shift 4G\":\"7373KT\"},vendor:{HTC:\"APA\",Sprint:\"Sprint\"}}},os:{windows:{version:{ME:\"4.90\",\"NT 3.11\":\"NT3.51\",\"NT 4.0\":\"NT4.0\",2e3:\"NT 5.0\",XP:[\"NT 5.1\",\"NT 5.2\"],Vista:\"NT 6.0\",7:\"NT 6.1\",8:\"NT 6.2\",8.1:\"NT 6.3\",10:[\"NT 6.4\",\"NT 10.0\"],RT:\"ARM\"}}}},N={browser:[[/(opera\\smini)\\/([\\w\\.-]+)/i,/(opera\\s[mobiletab]+).+version\\/([\\w\\.-]+)/i,/(opera).+version\\/([\\w\\.]+)/i,/(opera)[\\/\\s]+([\\w\\.]+)/i],[c,d],[/\\s(opr)\\/([\\w\\.]+)/i],[[c,\"Opera\"],d],[/(kindle)\\/([\\w\\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\\/\\s]?([\\w\\.]+)*/i,/(avant\\s|iemobile|slim|baidu)(?:browser)?[\\/\\s]?([\\w\\.]*)/i,/(?:ms|\\()(ie)\\s([\\w\\.]+)/i,/(rekonq)\\/([\\w\\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs)\\/([\\w\\.-]+)/i],[c,d],[/(trident).+rv[:\\s]([\\w\\.]+).+like\\sgecko/i],[[c,\"IE\"],d],[/(edge)\\/((\\d+)?[\\w\\.]+)/i],[c,d],[/(yabrowser)\\/([\\w\\.]+)/i],[[c,\"Yandex\"],d],[/(comodo_dragon)\\/([\\w\\.]+)/i],[[c,/_/g,\" \"],d],[/(chrome|omniweb|arora|[tizenoka]{5}\\s?browser)\\/v?([\\w\\.]+)/i,/(qqbrowser)[\\/\\s]?([\\w\\.]+)/i],[c,d],[/(uc\\s?browser)[\\/\\s]?([\\w\\.]+)/i,/ucweb.+(ucbrowser)[\\/\\s]?([\\w\\.]+)/i,/JUC.+(ucweb)[\\/\\s]?([\\w\\.]+)/i],[[c,\"UCBrowser\"],d],[/(dolfin)\\/([\\w\\.]+)/i],[[c,\"Dolphin\"],d],[/((?:android.+)crmo|crios)\\/([\\w\\.]+)/i],[[c,\"Chrome\"],d],[/XiaoMi\\/MiuiBrowser\\/([\\w\\.]+)/i],[d,[c,\"MIUI Browser\"]],[/android.+version\\/([\\w\\.]+)\\s+(?:mobile\\s?safari|safari)/i],[d,[c,\"Android Browser\"]],[/FBAV\\/([\\w\\.]+);/i],[d,[c,\"Facebook\"]],[/fxios\\/([\\w\\.-]+)/i],[d,[c,\"Firefox\"]],[/version\\/([\\w\\.]+).+?mobile\\/\\w+\\s(safari)/i],[d,[c,\"Mobile Safari\"]],[/version\\/([\\w\\.]+).+?(mobile\\s?safari|safari)/i],[d,c],[/webkit.+?(mobile\\s?safari|safari)(\\/[\\w\\.]+)/i],[c,[d,x.str,T.browser.oldsafari.version]],[/(konqueror)\\/([\\w\\.]+)/i,/(webkit|khtml)\\/([\\w\\.]+)/i],[c,d],[/(navigator|netscape)\\/([\\w\\.-]+)/i],[[c,\"Netscape\"],d],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\\sbrowser|minimo|conkeror)[\\/\\s]?([\\w\\.\\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\\/([\\w\\.-]+)/i,/(mozilla)\\/([\\w\\.]+).+rv\\:.+gecko\\/\\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\\/\\s]?([\\w\\.]+)/i,/(links)\\s\\(([\\w\\.]+)/i,/(gobrowser)\\/?([\\w\\.]+)*/i,/(ice\\s?browser)\\/v?([\\w\\._]+)/i,/(mosaic)[\\/\\s]([\\w\\.]+)/i],[c,d]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\\)]/i],[[v,\"amd64\"]],[/(ia32(?=;))/i],[[v,S.lowerize]],[/((?:i[346]|x)86)[;\\)]/i],[[v,\"ia32\"]],[/windows\\s(ce|mobile);\\sppc;/i],[[v,\"arm\"]],[/((?:ppc|powerpc)(?:64)?)(?:\\smac|;|\\))/i],[[v,/ower/,\"\",S.lowerize]],[/(sun4\\w)[;\\)]/i],[[v,\"sparc\"]],[/((?:avr32|ia64(?=;))|68k(?=\\))|arm(?:64|(?=v\\d+;))|(?=atmel\\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[v,S.lowerize]]],device:[[/\\((ipad|playbook);[\\w\\s\\);-]+(rim|apple)/i],[l,p,[h,y]],[/applecoremedia\\/[\\w\\.]+ \\((ipad)/],[l,[p,\"Apple\"],[h,y]],[/(apple\\s{0,1}tv)/i],[[l,\"Apple TV\"],[p,\"Apple\"]],[/(archos)\\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(kindle)\\/([\\w\\.]+)/i,/\\s(nook)[\\w\\s]+build\\/(\\w+)/i,/(dell)\\s(strea[kpr\\s\\d]*[\\dko])/i],[p,l,[h,y]],[/(kf[A-z]+)\\sbuild\\/[\\w\\.]+.*silk\\//i],[l,[p,\"Amazon\"],[h,y]],[/(sd|kf)[0349hijorstuw]+\\sbuild\\/[\\w\\.]+.*silk\\//i],[[l,x.str,T.device.amazon.model],[p,\"Amazon\"],[h,g]],[/\\((ip[honed|\\s\\w*]+);.+(apple)/i],[l,p,[h,g]],[/\\((ip[honed|\\s\\w*]+);/i],[l,[p,\"Apple\"],[h,g]],[/(blackberry)[\\s-]?(\\w+)/i,/(blackberry|benq|palm(?=\\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\\s_-]?([\\w-]+)*/i,/(hp)\\s([\\w\\s]+\\w)/i,/(asus)-?(\\w+)/i],[p,l,[h,g]],[/\\(bb10;\\s(\\w+)/i],[l,[p,\"BlackBerry\"],[h,g]],[/android.+(transfo[prime\\s]{4,10}\\s\\w+|eeepc|slider\\s\\w+|nexus 7)/i],[l,[p,\"Asus\"],[h,y]],[/(sony)\\s(tablet\\s[ps])\\sbuild\\//i,/(sony)?(?:sgp.+)\\sbuild\\//i],[[p,\"Sony\"],[l,\"Xperia Tablet\"],[h,y]],[/(?:sony)?(?:(?:(?:c|d)\\d{4})|(?:so[-l].+))\\sbuild\\//i],[[p,\"Sony\"],[l,\"Xperia Phone\"],[h,g]],[/\\s(ouya)\\s/i,/(nintendo)\\s([wids3u]+)/i],[p,l,[h,m]],[/android.+;\\s(shield)\\sbuild/i],[l,[p,\"Nvidia\"],[h,m]],[/(playstation\\s[34portablevi]+)/i],[l,[p,\"Sony\"],[h,m]],[/(sprint\\s(\\w+))/i],[[p,x.str,T.device.sprint.vendor],[l,x.str,T.device.sprint.model],[h,g]],[/(lenovo)\\s?(S(?:5000|6000)+(?:[-][\\w+]))/i],[p,l,[h,y]],[/(htc)[;_\\s-]+([\\w\\s]+(?=\\))|\\w+)*/i,/(zte)-(\\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\\s)sony)[_\\s-]?([\\w-]+)*/i],[p,[l,/_/g,\" \"],[h,g]],[/(nexus\\s9)/i],[l,[p,\"HTC\"],[h,y]],[/[\\s\\(;](xbox(?:\\sone)?)[\\s\\);]/i],[l,[p,\"Microsoft\"],[h,m]],[/(kin\\.[onetw]{3})/i],[[l,/\\./g,\" \"],[p,\"Microsoft\"],[h,g]],[/\\s(milestone|droid(?:[2-4x]|\\s(?:bionic|x2|pro|razr))?(:?\\s4g)?)[\\w\\s]+build\\//i,/mot[\\s-]?(\\w+)*/i,/(XT\\d{3,4}) build\\//i,/(nexus\\s[6])/i],[l,[p,\"Motorola\"],[h,g]],[/android.+\\s(mz60\\d|xoom[\\s2]{0,2})\\sbuild\\//i],[l,[p,\"Motorola\"],[h,y]],[/android.+((sch-i[89]0\\d|shw-m380s|gt-p\\d{4}|gt-n8000|sgh-t8[56]9|nexus 10))/i,/((SM-T\\w+))/i],[[p,\"Samsung\"],l,[h,y]],[/((s[cgp]h-\\w+|gt-\\w+|galaxy\\snexus|sm-n900))/i,/(sam[sung]*)[\\s-]*(\\w+-?[\\w-]*)*/i,/sec-((sgh\\w+))/i],[[p,\"Samsung\"],l,[h,g]],[/(samsung);smarttv/i],[p,l,[h,b]],[/\\(dtv[\\);].+(aquos)/i],[l,[p,\"Sharp\"],[h,b]],[/sie-(\\w+)*/i],[l,[p,\"Siemens\"],[h,g]],[/(maemo|nokia).*(n900|lumia\\s\\d+)/i,/(nokia)[\\s_-]?([\\w-]+)*/i],[[p,\"Nokia\"],l,[h,g]],[/android\\s3\\.[\\s\\w;-]{10}(a\\d{3})/i],[l,[p,\"Acer\"],[h,y]],[/android\\s3\\.[\\s\\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[p,\"LG\"],l,[h,y]],[/(lg) netcast\\.tv/i],[p,l,[h,b]],[/(nexus\\s[45])/i,/lg[e;\\s\\/-]+(\\w+)*/i],[l,[p,\"LG\"],[h,g]],[/android.+(ideatab[a-z0-9\\-\\s]+)/i],[l,[p,\"Lenovo\"],[h,y]],[/linux;.+((jolla));/i],[p,l,[h,g]],[/((pebble))app\\/[\\d\\.]+\\s/i],[p,l,[h,w]],[/android.+;\\s(glass)\\s\\d/i],[l,[p,\"Google\"],[h,w]],[/android.+(\\w+)\\s+build\\/hm\\1/i,/android.+(hm[\\s\\-_]*note?[\\s_]*(?:\\d\\w)?)\\s+build/i,/android.+(mi[\\s\\-_]*(?:one|one[\\s_]plus)?[\\s_]*(?:\\d\\w)?)\\s+build/i],[[l,/_/g,\" \"],[p,\"Xiaomi\"],[h,g]],[/\\s(tablet)[;\\/\\s]/i,/\\s(mobile)[;\\/\\s]/i],[[h,S.lowerize],p,l]],engine:[[/windows.+\\sedge\\/([\\w\\.]+)/i],[d,[c,\"EdgeHTML\"]],[/(presto)\\/([\\w\\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\\/([\\w\\.]+)/i,/(khtml|tasman|links)[\\/\\s]\\(?([\\w\\.]+)/i,/(icab)[\\/\\s]([23]\\.[\\d\\.]+)/i],[c,d],[/rv\\:([\\w\\.]+).*(gecko)/i],[d,c]],os:[[/microsoft\\s(windows)\\s(vista|xp)/i],[c,d],[/(windows)\\snt\\s6\\.2;\\s(arm)/i,/(windows\\sphone(?:\\sos)*|windows\\smobile|windows)[\\s\\/]?([ntce\\d\\.\\s]+\\w)/i],[c,[d,x.str,T.os.windows.version]],[/(win(?=3|9|n)|win\\s9x\\s)([nt\\d\\.]+)/i],[[c,\"Windows\"],[d,x.str,T.os.windows.version]],[/\\((bb)(10);/i],[[c,\"BlackBerry\"],d],[/(blackberry)\\w*\\/?([\\w\\.]+)*/i,/(tizen)[\\/\\s]([\\w\\.]+)/i,/(android|webos|palm\\sos|qnx|bada|rim\\stablet\\sos|meego|contiki)[\\/\\s-]?([\\w\\.]+)*/i,/linux;.+(sailfish);/i],[c,d],[/(symbian\\s?os|symbos|s60(?=;))[\\/\\s-]?([\\w\\.]+)*/i],[[c,\"Symbian\"],d],[/\\((series40);/i],[c],[/mozilla.+\\(mobile;.+gecko.+firefox/i],[[c,\"Firefox OS\"],d],[/(nintendo|playstation)\\s([wids34portablevu]+)/i,/(mint)[\\/\\s\\(]?(\\w+)*/i,/(mageia|vectorlinux)[;\\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|(?=\\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\\/\\s-]?([\\w\\.-]+)*/i,/(hurd|linux)\\s?([\\w\\.]+)*/i,/(gnu)\\s?([\\w\\.]+)*/i],[c,d],[/(cros)\\s[\\w]+\\s([\\w\\.]+\\w)/i],[[c,\"Chromium OS\"],d],[/(sunos)\\s?([\\w\\.]+\\d)*/i],[[c,\"Solaris\"],d],[/\\s([frentopc-]{0,4}bsd|dragonfly)\\s?([\\w\\.]+)*/i],[c,d],[/(ip[honead]+)(?:.*os\\s([\\w]+)*\\slike\\smac|;\\sopera)/i],[[c,\"iOS\"],[d,/_/g,\".\"]],[/(mac\\sos\\sx)\\s?([\\w\\s\\.]+\\w)*/i,/(macintosh|mac(?=_powerpc)\\s)/i],[[c,\"Mac OS\"],[d,/_/g,\".\"]],[/((?:open)?solaris)[\\/\\s-]?([\\w\\.]+)*/i,/(haiku)\\s(\\w+)/i,/(aix)\\s((\\d)(?=\\.|\\)|\\s)[\\w\\.]*)*/i,/(plan\\s9|minix|beos|os\\/2|amigaos|morphos|risc\\sos|openvms)/i,/(unix)\\s?([\\w\\.]+)*/i],[c,d]]},C=function(t,n){if(this instanceof C){var i=t||(e&&e.navigator&&e.navigator.userAgent?e.navigator.userAgent:r),s=n?S.extend(N,n):N;return this.getBrowser=function(){var e=x.rgx.apply(this,s.browser);return e.major=S.major(e.version),e},this.getCPU=function(){return x.rgx.apply(this,s.cpu)},this.getDevice=function(){return x.rgx.apply(this,s.device)},this.getEngine=function(){return x.rgx.apply(this,s.engine)},this.getOS=function(){return x.rgx.apply(this,s.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i=e,this},this.setUA(i),this}return(new C(t,n)).getResult()};C.VERSION=n,C.BROWSER={NAME:c,MAJOR:f,VERSION:d},C.CPU={ARCHITECTURE:v},C.DEVICE={MODEL:l,VENDOR:p,TYPE:h,CONSOLE:m,MOBILE:g,SMARTTV:b,TABLET:y,WEARABLE:w,EMBEDDED:E},C.ENGINE={NAME:c,VERSION:d},C.OS={NAME:c,VERSION:d},typeof exports!==o?(typeof module!==o&&module.exports&&(exports=module.exports=C),exports.UAParser=C):typeof define===s&&define.amd?define(function(){return C}):e.UAParser=C;var k=e.jQuery||e.Zepto;if(typeof k!==o){var L=new C;k.ua=L.getResult(),k.ua.get=function(){return L.getUA()},k.ua.set=function(e){L.setUA(e);var t=L.getResult();for(var n in t)k.ua[n]=t[n]}}})(typeof window==\"object\"?window:this);\n","RocketChat.theme.addPackageAsset(() => {\n\treturn Assets.getText('client/stylesheets/livechat.less');\n});\n","RocketChat.callbacks.add('afterSaveMessage', function(message, room) {\n\t// skips this callback if the message was edited\n\tif (message.editedAt) {\n\t\treturn message;\n\t}\n\n\t// check if room is yet awaiting for response\n\tif (!(typeof room.t !== 'undefined' && room.t === 'l' && room.waitingResponse)) {\n\t\treturn message;\n\t}\n\n\t// if the message has a token, it was sent by the visitor, so ignore it\n\tif (message.token) {\n\t\treturn message;\n\t}\n\n\tMeteor.defer(() => {\n\t\tlet now = new Date();\n\t\tRocketChat.models.Rooms.setResponseByRoomId(room._id, {\n\t\t\tuser: {\n\t\t\t\t_id: message.u._id,\n\t\t\t\tusername: message.u.username\n\t\t\t},\n\t\t\tresponseDate: now,\n\t\t\tresponseTime: (now.getTime() - room.ts) / 1000\n\t\t});\n\t});\n\n\treturn message;\n}, RocketChat.callbacks.priority.LOW, 'markRoomResponded');\n","Meteor.methods({\n\t'livechat:addAgent'(username) {\n\t\tif (!Meteor.userId() || !RocketChat.authz.hasPermission(Meteor.userId(), 'view-livechat-manager')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'livechat:addAgent' });\n\t\t}\n\n\t\tif (!username || !_.isString(username)) {\n\t\t\tthrow new Meteor.Error('error-invalid-arguments', 'Invalid arguments', { method: 'livechat:addAgent' });\n\t\t}\n\n\t\tvar user = RocketChat.models.Users.findOneByUsername(username, { fields: { _id: 1 } });\n\n\t\tif (!user) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'livechat:addAgent' });\n\t\t}\n\n\t\tif (RocketChat.authz.addUserRoles(user._id, 'livechat-agent')) {\n\t\t\tRocketChat.models.Users.setOperator(user._id, true);\n\t\t\tRocketChat.models.Users.setLivechatStatus(user._id, 'available');\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n});\n","Meteor.methods({\n\t'livechat:addManager'(username) {\n\t\tif (!Meteor.userId() || !RocketChat.authz.hasPermission(Meteor.userId(), 'view-livechat-manager')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'livechat:addManager' });\n\t\t}\n\n\t\tif (!username || !_.isString(username)) {\n\t\t\tthrow new Meteor.Error('error-invalid-arguments', 'Invalid arguments', { method: 'livechat:addManager' });\n\t\t}\n\n\t\tvar user = RocketChat.models.Users.findOneByUsername(username, { fields: { _id: 1 } });\n\n\t\tif (!user) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'livechat:addManager' });\n\t\t}\n\n\t\treturn RocketChat.authz.addUserRoles(user._id, 'livechat-manager');\n\t}\n});\n","Meteor.methods({\n\t'livechat:changeLivechatStatus'() {\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'livechat:changeLivechatStatus' });\n\t\t}\n\n\t\tconst user = Meteor.user();\n\n\t\tlet newStatus = user.statusLivechat === 'available' ? 'not-available' : 'available';\n\n\t\treturn RocketChat.models.Users.setLivechatStatus(user._id, newStatus);\n\t}\n});\n","Meteor.methods({\n\t'livechat:closeRoom'(roomId, comment) {\n\t\tif (!Meteor.userId() || !RocketChat.authz.hasPermission(Meteor.userId(), 'close-livechat-room')) {\n\t\t\tthrow new Meteor.Error('error-not-authorized', 'Not authorized', { method: 'livechat:closeRoom' });\n\t\t}\n\n\t\tconst room = RocketChat.models.Rooms.findOneById(roomId);\n\n\t\tconst user = Meteor.user();\n\n\t\tif (room.usernames.indexOf(user.username) === -1 && !RocketChat.authz.hasPermission(Meteor.userId(), 'close-others-livechat-room')) {\n\t\t\tthrow new Meteor.Error('error-not-authorized', 'Not authorized', { method: 'livechat:closeRoom' });\n\t\t}\n\n\t\treturn RocketChat.Livechat.closeRoom({\n\t\t\tuser: user,\n\t\t\troom: room,\n\t\t\tcomment: comment\n\t\t});\n\t}\n});\n","Meteor.methods({\n\t'livechat:getCustomFields'() {\n\t\treturn RocketChat.models.LivechatCustomField.find().fetch();\n\t}\n});\n","Meteor.methods({\n\t'livechat:getInitialData'(visitorToken) {\n\t\tvar info = {\n\t\t\tenabled: null,\n\t\t\ttitle: null,\n\t\t\tcolor: null,\n\t\t\tregistrationForm: null,\n\t\t\troom: null,\n\t\t\ttriggers: [],\n\t\t\tdepartments: [],\n\t\t\tonline: true,\n\t\t\tofflineColor: null,\n\t\t\tofflineMessage: null,\n\t\t\tofflineSuccessMessage: null,\n\t\t\tofflineUnavailableMessage: null,\n\t\t\tdisplayOfflineForm: null\n\t\t};\n\n\t\tconst room = RocketChat.models.Rooms.findOpenByVisitorToken(visitorToken, {\n\t\t\tfields: {\n\t\t\t\tname: 1,\n\t\t\t\tt: 1,\n\t\t\t\tcl: 1,\n\t\t\t\tu: 1,\n\t\t\t\tusernames: 1,\n\t\t\t\tv: 1\n\t\t\t}\n\t\t}).fetch();\n\n\t\tif (room && room.length > 0) {\n\t\t\tinfo.room = room[0];\n\t\t}\n\n\t\tconst initSettings = RocketChat.Livechat.getInitSettings();\n\n\t\tinfo.title = initSettings.Livechat_title;\n\t\tinfo.color = initSettings.Livechat_title_color;\n\t\tinfo.enabled = initSettings.Livechat_enabled;\n\t\tinfo.registrationForm = initSettings.Livechat_registration_form;\n\t\tinfo.offlineTitle = initSettings.Livechat_offline_title;\n\t\tinfo.offlineColor = initSettings.Livechat_offline_title_color;\n\t\tinfo.offlineMessage = initSettings.Livechat_offline_message;\n\t\tinfo.offlineSuccessMessage = initSettings.Livechat_offline_success_message;\n\t\tinfo.offlineUnavailableMessage = initSettings.Livechat_offline_form_unavailable;\n\t\tinfo.displayOfflineForm = initSettings.Livechat_display_offline_form;\n\t\tinfo.language = initSettings.Language;\n\n\t\tRocketChat.models.LivechatTrigger.find().forEach((trigger) => {\n\t\t\tinfo.triggers.push(trigger);\n\t\t});\n\n\t\tRocketChat.models.LivechatDepartment.findEnabledWithAgents().forEach((department) => {\n\t\t\tinfo.departments.push(department);\n\t\t});\n\n\t\tinfo.online = RocketChat.models.Users.findOnlineAgents().count() > 0;\n\n\t\treturn info;\n\t}\n});\n","Meteor.methods({\n\t'livechat:pageVisited'(token, pageInfo) {\n\t\treturn RocketChat.Livechat.savePageHistory(token, pageInfo);\n\t}\n});\n","Meteor.methods({\n\t'livechat:registerGuest': function({ token, name, email, department } = {}) {\n\t\tvar stampedToken = Accounts._generateStampedLoginToken();\n\t\tvar hashStampedToken = Accounts._hashStampedToken(stampedToken);\n\n\t\tlet userId = RocketChat.Livechat.registerGuest.call(this, {\n\t\t\ttoken: token,\n\t\t\tname: name,\n\t\t\temail: email,\n\t\t\tdepartment: department,\n\t\t\tloginToken: hashStampedToken\n\t\t});\n\n\t\t// update visited page history to not expire\n\t\tRocketChat.models.LivechatPageVisited.keepHistoryForToken(token);\n\n\t\treturn {\n\t\t\tuserId: userId,\n\t\t\ttoken: stampedToken.token\n\t\t};\n\t}\n});\n","Meteor.methods({\n\t'livechat:removeAgent'(username) {\n\t\tif (!Meteor.userId() || !RocketChat.authz.hasPermission(Meteor.userId(), 'view-livechat-manager')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'livechat:removeAgent' });\n\t\t}\n\n\t\tif (!username || !_.isString(username)) {\n\t\t\tthrow new Meteor.Error('error-invalid-arguments', 'Invalid arguments', { method: 'livechat:removeAgent' });\n\t\t}\n\n\t\tvar user = RocketChat.models.Users.findOneByUsername(username, { fields: { _id: 1 } });\n\n\t\tif (!user) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'livechat:removeAgent' });\n\t\t}\n\n\t\tif (RocketChat.authz.removeUserFromRoles(user._id, 'livechat-agent')) {\n\t\t\tRocketChat.models.Users.setOperator(user._id, false);\n\t\t\tRocketChat.models.Users.setLivechatStatus(user._id, 'not-available');\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n});\n","Meteor.methods({\n\t'livechat:removeCustomField'(_id) {\n\t\tif (!Meteor.userId() || !RocketChat.authz.hasPermission(Meteor.userId(), 'view-livechat-manager')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'livechat:removeCustomField' });\n\t\t}\n\n\t\tcheck(_id, String);\n\n\t\tvar customField = RocketChat.models.LivechatCustomField.findOneById(_id, { fields: { _id: 1 } });\n\n\t\tif (!customField) {\n\t\t\tthrow new Meteor.Error('error-invalid-custom-field', 'Custom field not found', { method: 'livechat:removeCustomField' });\n\t\t}\n\n\t\treturn RocketChat.models.LivechatCustomField.removeById(_id);\n\t}\n});\n","Meteor.methods({\n\t'livechat:removeDepartment'(_id) {\n\t\tif (!Meteor.userId() || !RocketChat.authz.hasPermission(Meteor.userId(), 'view-livechat-manager')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'livechat:removeDepartment' });\n\t\t}\n\n\t\tcheck(_id, String);\n\n\t\tvar department = RocketChat.models.LivechatDepartment.findOneById(_id, { fields: { _id: 1 } });\n\n\t\tif (!department) {\n\t\t\tthrow new Meteor.Error('department-not-found', 'Department not found', { method: 'livechat:removeDepartment' });\n\t\t}\n\n\t\treturn RocketChat.models.LivechatDepartment.removeById(_id);\n\t}\n});\n","Meteor.methods({\n\t'livechat:removeManager'(username) {\n\t\tif (!Meteor.userId() || !RocketChat.authz.hasPermission(Meteor.userId(), 'view-livechat-manager')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'livechat:removeManager' });\n\t\t}\n\n\t\tcheck(username, String);\n\n\t\tvar user = RocketChat.models.Users.findOneByUsername(username, { fields: { _id: 1 } });\n\n\t\tif (!user) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'livechat:removeManager' });\n\t\t}\n\n\t\treturn RocketChat.authz.removeUserFromRoles(user._id, 'livechat-manager');\n\t}\n});\n","Meteor.methods({\n\t'livechat:removeTrigger'(/*trigger*/) {\n\t\tif (!Meteor.userId() || !RocketChat.authz.hasPermission(Meteor.userId(), 'view-livechat-manager')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'livechat:removeTrigger' });\n\t\t}\n\n\t\treturn RocketChat.models.LivechatTrigger.removeAll();\n\t}\n});\n","/* eslint new-cap: [2, {\"capIsNewExceptions\": [\"Match.ObjectIncluding\", \"Match.Optional\"]}] */\n\nMeteor.methods({\n\t'livechat:saveCustomField'(_id, customFieldData) {\n\t\tif (!Meteor.userId() || !RocketChat.authz.hasPermission(Meteor.userId(), 'view-livechat-manager')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'livechat:saveCustomField' });\n\t\t}\n\n\t\tif (_id) {\n\t\t\tcheck(_id, String);\n\t\t}\n\n\t\tcheck(customFieldData, Match.ObjectIncluding({ field: String, label: String, scope: String, visibility: String }));\n\n\t\tif (!/^[0-9a-zA-Z-_]+$/.test(customFieldData.field)) {\n\t\t\tthrow new Meteor.Error('error-invalid-custom-field-nmae', 'Invalid custom field name. Use only letters, numbers, hyphens and underscores.', { method: 'livechat:saveCustomField' });\n\t\t}\n\n\t\tif (_id) {\n\t\t\tconst customField = RocketChat.models.LivechatCustomField.findOneById(_id);\n\t\t\tif (!customField) {\n\t\t\t\tthrow new Meteor.Error('error-invalid-custom-field', 'Custom Field Not found', { method: 'livechat:saveCustomField' });\n\t\t\t}\n\t\t}\n\n\t\treturn RocketChat.models.LivechatCustomField.createOrUpdateCustomField(_id, customFieldData.field, customFieldData.label, customFieldData.scope, customFieldData.visibility);\n\t}\n});\n","/* eslint new-cap: [2, {\"capIsNewExceptions\": [\"Match.ObjectIncluding\", \"Match.Optional\"]}] */\n\nMeteor.methods({\n\t'livechat:saveDepartment'(_id, departmentData, departmentAgents) {\n\t\tif (!Meteor.userId() || !RocketChat.authz.hasPermission(Meteor.userId(), 'view-livechat-manager')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'livechat:saveDepartment' });\n\t\t}\n\n\t\tif (_id) {\n\t\t\tcheck(_id, String);\n\t\t}\n\n\t\tcheck(departmentData, Match.ObjectIncluding({ enabled: Boolean, name: String, description: Match.Optional(String), agents: Match.Optional([Match.ObjectIncluding({ _id: String, username: String })]) }));\n\n\t\tif (_id) {\n\t\t\tconst department = RocketChat.models.LivechatDepartment.findOneById(_id);\n\t\t\tif (!department) {\n\t\t\t\tthrow new Meteor.Error('error-department-not-found', 'Department not found', { method: 'livechat:saveDepartment' });\n\t\t\t}\n\t\t}\n\n\t\treturn RocketChat.models.LivechatDepartment.createOrUpdateDepartment(_id, departmentData.enabled, departmentData.name, departmentData.description, departmentAgents);\n\t}\n});\n","Meteor.methods({\n\t'livechat:saveIntegration'(values) {\n\t\tif (!Meteor.userId() || !RocketChat.authz.hasPermission(Meteor.userId(), 'view-livechat-manager')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'livechat:saveIntegration' });\n\t\t}\n\n\t\tif (typeof values['Livechat_webhookUrl'] !== 'undefined') {\n\t\t\tRocketChat.settings.updateById('Livechat_webhookUrl', s.trim(values['Livechat_webhookUrl']));\n\t\t}\n\n\t\tif (typeof values['Livechat_secret_token'] !== 'undefined') {\n\t\t\tRocketChat.settings.updateById('Livechat_secret_token', s.trim(values['Livechat_secret_token']));\n\t\t}\n\n\t\tif (typeof values['Livechat_webhook_on_close'] !== 'undefined') {\n\t\t\tRocketChat.settings.updateById('Livechat_webhook_on_close', !!values['Livechat_webhook_on_close']);\n\t\t}\n\n\t\tif (typeof values['Livechat_webhook_on_offline_msg'] !== 'undefined') {\n\t\t\tRocketChat.settings.updateById('Livechat_webhook_on_offline_msg', !!values['Livechat_webhook_on_offline_msg']);\n\t\t}\n\n\t\treturn;\n\t}\n});\n","/* eslint new-cap: [2, {\"capIsNewExceptions\": [\"Match.ObjectIncluding\", \"Match.Optional\"]}] */\n\nMeteor.methods({\n\t'livechat:saveLivechatInfo': function(guestData, roomData) {\n\t\tif (!Meteor.userId() || !RocketChat.authz.hasPermission(Meteor.userId(), 'view-l-room')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'livechat:saveLivechatInfo' });\n\t\t}\n\n\t\tcheck(guestData, Match.ObjectIncluding({\n\t\t\t_id: String,\n\t\t\tname: Match.Optional(String),\n\t\t\temail: Match.Optional(String),\n\t\t\tphone: Match.Optional(String)\n\t\t}));\n\n\t\tcheck(roomData, Match.ObjectIncluding({\n\t\t\t_id: String,\n\t\t\ttopic: Match.Optional(String),\n\t\t\ttags: Match.Optional(String)\n\t\t}));\n\n\t\treturn RocketChat.Livechat.saveGuest(guestData) && RocketChat.Livechat.saveRoomInfo(roomData, guestData);\n\t}\n});\n","/* eslint new-cap: [2, {\"capIsNewExceptions\": [\"Match.ObjectIncluding\"]}] */\n\nMeteor.methods({\n\t'livechat:saveSurveyFeedback'(visitorToken, visitorRoom, formData) {\n\t\tcheck(visitorToken, String);\n\t\tcheck(visitorRoom, String);\n\t\tcheck(formData, [Match.ObjectIncluding({ name: String, value: String })]);\n\n\t\tconst visitor = RocketChat.models.Users.getVisitorByToken(visitorToken);\n\t\tconst room = RocketChat.models.Rooms.findOneById(visitorRoom);\n\n\t\tif (visitor !== undefined && room !== undefined && room.v !== undefined && visitor.profile !== undefined && room.v.token === visitor.profile.token) {\n\t\t\tconst updateData = {};\n\t\t\tfor (var item of formData) {\n\t\t\t\tif (_.contains(['satisfaction', 'agentKnowledge', 'agentResposiveness', 'agentFriendliness'], item.name) && _.contains(['1', '2', '3', '4', '5'], item.value)) {\n\t\t\t\t\tupdateData[item.name] = item.value;\n\t\t\t\t} else if (item.name === 'additionalFeedback') {\n\t\t\t\t\tupdateData[item.name] = item.value;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!_.isEmpty(updateData)) {\n\t\t\t\treturn RocketChat.models.Rooms.updateSurveyFeedbackById(room._id, updateData);\n\t\t\t}\n\t\t}\n\t}\n});\n","Meteor.methods({\n\t'livechat:saveTrigger'(trigger) {\n\t\tif (!Meteor.userId() || !RocketChat.authz.hasPermission(Meteor.userId(), 'view-livechat-manager')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'livechat:saveTrigger' });\n\t\t}\n\n\t\treturn RocketChat.models.LivechatTrigger.save(trigger);\n\t}\n});\n","Meteor.methods({\n\t'livechat:searchAgent'(username) {\n\t\tif (!Meteor.userId() || !RocketChat.authz.hasPermission(Meteor.userId(), 'view-livechat-manager')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'livechat:searchAgent' });\n\t\t}\n\n\t\tif (!username || !_.isString(username)) {\n\t\t\tthrow new Meteor.Error('error-invalid-arguments', 'Invalid arguments', { method: 'livechat:searchAgent' });\n\t\t}\n\n\t\tvar user = RocketChat.models.Users.findOneByUsername(username, { fields: { _id: 1, username: 1 } });\n\n\t\tif (!user) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'livechat:searchAgent' });\n\t\t}\n\n\t\treturn user;\n\t}\n});\n","Meteor.methods({\n\tsendMessageLivechat: function(message) {\n\t\tvar guest;\n\n\t\tcheck(message.rid, String);\n\t\tcheck(message.token, String);\n\n\t\tguest = Meteor.users.findOne(Meteor.userId(), {\n\t\t\tfields: {\n\t\t\t\tname: 1,\n\t\t\t\tusername: 1,\n\t\t\t\tdepartment: 1\n\t\t\t}\n\t\t});\n\n\t\treturn RocketChat.Livechat.sendMessage({ guest: guest, message: message });\n\t}\n});\n","/* globals DDPRateLimiter */\nMeteor.methods({\n\t'livechat:sendOfflineMessage'(data) {\n\t\tcheck(data, {\n\t\t\tname: String,\n\t\t\temail: String,\n\t\t\tmessage: String\n\t\t});\n\n\t\tconst header = RocketChat.placeholders.replace(RocketChat.settings.get('Email_Header') || '');\n\t\tconst footer = RocketChat.placeholders.replace(RocketChat.settings.get('Email_Footer') || '');\n\n\t\tconst message = (data.message + '').replace(/([^>\\r\\n]?)(\\r\\n|\\n\\r|\\r|\\n)/g, '$1' + '<br>' + '$2');\n\n\t\tconst html = `\n\t\t\t<h1>New livechat message</h1>\n\t\t\t<p><strong>Visitor name:</strong> ${data.name}</p>\n\t\t\t<p><strong>Visitor email:</strong> ${data.email}</p>\n\t\t\t<p><strong>Message:</strong><br>${message}</p>`;\n\n\t\tlet fromEmail = RocketChat.settings.get('From_Email').match(/\\b[A-Z0-9._%+-]+@(?:[A-Z0-9-]+\\.)+[A-Z]{2,4}\\b/i);\n\n\t\tif (fromEmail) {\n\t\t\tfromEmail = fromEmail[0];\n\t\t} else {\n\t\t\tfromEmail = RocketChat.settings.get('From_Email');\n\t\t}\n\n\t\tMeteor.defer(() => {\n\t\t\tEmail.send({\n\t\t\t\tto: RocketChat.settings.get('Livechat_offline_email'),\n\t\t\t\tfrom: `${data.name} - ${data.email} <${fromEmail}>`,\n\t\t\t\treplyTo: `${data.name} <${data.email}>`,\n\t\t\t\tsubject: `Livechat offline message from ${data.name}: ${(data.message + '').substring(0, 20)}`,\n\t\t\t\thtml: header + html + footer\n\t\t\t});\n\t\t});\n\n\t\tMeteor.defer(() => {\n\t\t\tRocketChat.callbacks.run('sendOfflineLivechatMessage', data);\n\t\t});\n\n\t\treturn true;\n\t}\n});\n\nDDPRateLimiter.addRule({\n\ttype: 'method',\n\tname: 'livechat:sendOfflineMessage',\n\tconnectionId() {\n\t\treturn true;\n\t}\n}, 1, 5000);\n","Meteor.methods({\n\t'livechat:setCustomField'(token, key, value) {\n\t\tconst customField = RocketChat.models.LivechatCustomField.findOneById(key);\n\t\tif (customField) {\n\t\t\tif (customField.scope === 'room') {\n\t\t\t\treturn RocketChat.models.Rooms.updateLivechatDataByToken(token, key, value);\n\t\t\t} else {\n\t\t\t\t// Save in user\n\t\t\t\treturn RocketChat.models.Users.updateLivechatDataByToken(token, key, value);\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n});\n","/* eslint new-cap: [2, {\"capIsNewExceptions\": [\"Match.Optional\"]}] */\nMeteor.methods({\n\t'livechat:transfer'(transferData) {\n\t\tif (!Meteor.userId() || !RocketChat.authz.hasPermission(Meteor.userId(), 'view-l-room')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'livechat:transfer' });\n\t\t}\n\n\t\tcheck(transferData, {\n\t\t\troomId: String,\n\t\t\tuserId: Match.Optional(String),\n\t\t\tdeparmentId: Match.Optional(String)\n\t\t});\n\n\t\tconst room = RocketChat.models.Rooms.findOneById(transferData.roomId);\n\n\t\tconst guest = RocketChat.models.Users.findOneById(room.v._id);\n\n\t\tconst user = Meteor.user();\n\n\t\tif (room.usernames.indexOf(user.username) === -1) {\n\t\t\tthrow new Meteor.Error('error-not-authorized', 'Not authorized', { method: 'livechat:transfer' });\n\t\t}\n\n\t\treturn RocketChat.Livechat.transfer(room, guest, transferData);\n\t}\n});\n","/* globals HTTP */\nconst postCatchError = Meteor.wrapAsync(function(url, options, resolve) {\n\tHTTP.post(url, options, function(err, res) {\n\t\tif (err) {\n\t\t\tresolve(null, err.response);\n\t\t} else {\n\t\t\tresolve(null, res);\n\t\t}\n\t});\n});\n\nMeteor.methods({\n\t'livechat:webhookTest'() {\n\t\tthis.unblock();\n\n\t\tconst sampleData = {\n\t\t\ttype: 'LivechatSession',\n\t\t\t_id: 'fasd6f5a4sd6f8a4sdf',\n\t\t\tlabel: 'title',\n\t\t\ttopic: 'asiodojf',\n\t\t\tcode: 123123,\n\t\t\tcreatedAt: new Date(),\n\t\t\tlastMessageAt: new Date(),\n\t\t\ttags: [\n\t\t\t\t'tag1',\n\t\t\t\t'tag2',\n\t\t\t\t'tag3'\n\t\t\t],\n\t\t\tcustomFields: {\n\t\t\t\tproductId: '123456'\n\t\t\t},\n\t\t\tvisitor: {\n\t\t\t\t_id: '',\n\t\t\t\tname: 'visitor name',\n\t\t\t\tusername: 'visitor-username',\n\t\t\t\tdepartment: 'department',\n\t\t\t\temail: 'email@address.com',\n\t\t\t\tphone: '192873192873',\n\t\t\t\tip: '123.456.7.89',\n\t\t\t\tbrowser: 'Chrome',\n\t\t\t\tos: 'Linux',\n\t\t\t\tcustomFields: {\n\t\t\t\t\tcustomerId: '123456'\n\t\t\t\t}\n\t\t\t},\n\t\t\tagent: {\n\t\t\t\t_id: 'asdf89as6df8',\n\t\t\t\tusername: 'agent.username',\n\t\t\t\tname: 'Agent Name',\n\t\t\t\temail: 'agent@email.com'\n\t\t\t},\n\t\t\tmessages: [{\n\t\t\t\tusername: 'visitor-username',\n\t\t\t\tmsg: 'message content',\n\t\t\t\tts: new Date()\n\t\t\t}, {\n\t\t\t\tusername: 'agent.username',\n\t\t\t\tagentId: 'asdf89as6df8',\n\t\t\t\tmsg: 'message content from agent',\n\t\t\t\tts: new Date()\n\t\t\t}]\n\t\t};\n\n\t\tlet options = {\n\t\t\theaders: {\n\t\t\t\t'X-RocketChat-Livechat-Token': RocketChat.settings.get('Livechat_secret_token')\n\t\t\t},\n\t\t\tdata: sampleData\n\t\t};\n\n\t\tlet response = postCatchError(RocketChat.settings.get('Livechat_webhookUrl'), options);\n\n\t\tconsole.log('response ->', response);\n\n\t\tif (response && response.statusCode && response.statusCode === 200) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\tthrow new Meteor.Error('error-invalid-webhook-response');\n\t\t}\n\t}\n});\n\n","Meteor.methods({\n\t'livechat:takeInquiry'(inquiryId) {\n\t\tif (!Meteor.userId() || !RocketChat.authz.hasPermission(Meteor.userId(), 'view-l-room')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'livechat:takeInquiry' });\n\t\t}\n\n\t\tconst inquiry = RocketChat.models.LivechatInquiry.findOneById(inquiryId);\n\n\t\tif (!inquiry || inquiry.status === 'taken') {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Inquiry already taken', { method: 'livechat:takeInquiry' });\n\t\t}\n\n\t\tconst user = RocketChat.models.Users.findOneById(Meteor.userId());\n\n\t\tconst agent = {\n\t\t\tagentId: user._id,\n\t\t\tusername: user.username\n\t\t};\n\n\t\t// add subscription\n\t\tvar subscriptionData = {\n\t\t\trid: inquiry.rid,\n\t\t\tname: inquiry.name,\n\t\t\talert: true,\n\t\t\topen: true,\n\t\t\tunread: 1,\n\t\t\tcode: inquiry.code,\n\t\t\tu: {\n\t\t\t\t_id: agent.agentId,\n\t\t\t\tusername: agent.username\n\t\t\t},\n\t\t\tt: 'l',\n\t\t\tdesktopNotifications: 'all',\n\t\t\tmobilePushNotifications: 'all',\n\t\t\temailNotifications: 'all'\n\t\t};\n\t\tRocketChat.models.Subscriptions.insert(subscriptionData);\n\n\t\tconst room = RocketChat.models.Rooms.findOneById(inquiry.rid);\n\t\tconst usernames = room.usernames.concat(agent.username);\n\n\t\tRocketChat.models.Rooms.changeAgentByRoomId(inquiry.rid, usernames, agent);\n\n\t\t// mark inquiry as taken\n\t\tRocketChat.models.LivechatInquiry.takeInquiry(inquiry._id);\n\n\t\t// return room corresponding to inquiry (for redirecting agent to the room route)\n\t\treturn RocketChat.models.Rooms.findOneById(inquiry.rid);\n\t}\n});\n","Meteor.methods({\n\t'livechat:returnAsInquiry'(rid) {\n\t\tif (!Meteor.userId() || !RocketChat.authz.hasPermission(Meteor.userId(), 'view-l-room')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'livechat:saveDepartment' });\n\t\t}\n\n\t\t// //delete agent and room subscription\n\t\tRocketChat.models.Subscriptions.removeByRoomId(rid);\n\n\t\t// remove user from room\n\t\tvar username = Meteor.user().username;\n\n\t\tRocketChat.models.Rooms.removeUsernameById(rid, username);\n\n\t\t// find inquiry corresponding to room\n\t\tvar inquiry = RocketChat.models.LivechatInquiry.findOne({rid: rid});\n\n\t\t// mark inquiry as open\n\t\treturn RocketChat.models.LivechatInquiry.openInquiry(inquiry._id);\n\t}\n});\n","/**\n * Sets an user as (non)operator\n * @param {string} _id - User's _id\n * @param {boolean} operator - Flag to set as operator or not\n */\nRocketChat.models.Users.setOperator = function(_id, operator) {\n\tvar update = {\n\t\t$set: {\n\t\t\toperator: operator\n\t\t}\n\t};\n\n\treturn this.update(_id, update);\n};\n\n/**\n * Gets all online agents\n * @return\n */\nRocketChat.models.Users.findOnlineAgents = function() {\n\tvar query = {\n\t\tstatusConnection: { $ne: 'offline' },\n\t\tstatusLivechat: 'available',\n\t\troles: 'livechat-agent'\n\t};\n\n\treturn this.find(query);\n};\n\n/**\n * Gets all agents\n * @return\n */\nRocketChat.models.Users.findAgents = function() {\n\tvar query = {\n\t\troles: 'livechat-agent'\n\t};\n\n\treturn this.find(query);\n};\n\n/**\n * Find online users from a list\n * @param {array} userList - array of usernames\n * @return\n */\nRocketChat.models.Users.findOnlineUserFromList = function(userList) {\n\tvar query = {\n\t\tstatusConnection: { $ne: 'offline' },\n\t\tstatusLivechat: 'available',\n\t\troles: 'livechat-agent',\n\t\tusername: {\n\t\t\t$in: [].concat(userList)\n\t\t}\n\t};\n\n\treturn this.find(query);\n};\n\n/**\n * Get next user agent in order\n * @return {object} User from db\n */\nRocketChat.models.Users.getNextAgent = function() {\n\tvar query = {\n\t\tstatusConnection: { $ne: 'offline' },\n\t\tstatusLivechat: 'available',\n\t\troles: 'livechat-agent'\n\t};\n\n\tvar collectionObj = this.model.rawCollection();\n\tvar findAndModify = Meteor.wrapAsync(collectionObj.findAndModify, collectionObj);\n\n\tvar sort = {\n\t\tlivechatCount: 1,\n\t\tusername: 1\n\t};\n\n\tvar update = {\n\t\t$inc: {\n\t\t\tlivechatCount: 1\n\t\t}\n\t};\n\n\tvar user = findAndModify(query, sort, update);\n\tif (user) {\n\t\treturn {\n\t\t\tagentId: user._id,\n\t\t\tusername: user.username\n\t\t};\n\t} else {\n\t\treturn null;\n\t}\n};\n\n/**\n * Gets visitor by token\n * @param {string} token - Visitor token\n */\nRocketChat.models.Users.getVisitorByToken = function(token, options) {\n\tvar query = {\n\t\t'profile.guest': true,\n\t\t'profile.token': token\n\t};\n\n\treturn this.findOne(query, options);\n};\n\n/**\n * Gets visitor by token\n * @param {string} token - Visitor token\n */\nRocketChat.models.Users.findVisitorByToken = function(token) {\n\tvar query = {\n\t\t'profile.guest': true,\n\t\t'profile.token': token\n\t};\n\n\treturn this.find(query);\n};\n\n/**\n * Change user's livechat status\n * @param {string} token - Visitor token\n */\nRocketChat.models.Users.setLivechatStatus = function(userId, status) {\n\tlet query = {\n\t\t'_id': userId\n\t};\n\n\tlet update = {\n\t\t$set: {\n\t\t\t'statusLivechat': status\n\t\t}\n\t};\n\n\treturn this.update(query, update);\n};\n\nRocketChat.models.Users.updateLivechatDataByToken = function(token, key, value) {\n\tconst query = {\n\t\t'profile.token': token\n\t};\n\n\tconst update = {\n\t\t$set: {\n\t\t\t[`livechatData.${key}`]: value\n\t\t}\n\t};\n\n\treturn this.update(query, update);\n};\n\n/**\n * Find a visitor by their phone number\n * @return {object} User from db\n */\nRocketChat.models.Users.findOneVisitorByPhone = function(phone) {\n\tconst query = {\n\t\t'phone.phoneNumber': phone\n\t};\n\n\treturn this.findOne(query);\n};\n\n/**\n * Get the next visitor name\n * @return {string} The next visitor name\n */\nRocketChat.models.Users.getNextVisitorUsername = function() {\n\tconst settingsRaw = RocketChat.models.Settings.model.rawCollection();\n\tconst findAndModify = Meteor.wrapAsync(settingsRaw.findAndModify, settingsRaw);\n\n\tconst query = {\n\t\t_id: 'Livechat_guest_count'\n\t};\n\n\tconst update = {\n\t\t$inc: {\n\t\t\tvalue: 1\n\t\t}\n\t};\n\n\tconst livechatCount = findAndModify(query, null, update);\n\n\treturn 'guest-' + (livechatCount.value + 1);\n};\n","/**\n * Gets visitor by token\n * @param {string} token - Visitor token\n */\nRocketChat.models.Rooms.updateSurveyFeedbackById = function(_id, surveyFeedback) {\n\tconst query = {\n\t\t_id: _id\n\t};\n\n\tconst update = {\n\t\t$set: {\n\t\t\tsurveyFeedback: surveyFeedback\n\t\t}\n\t};\n\n\treturn this.update(query, update);\n};\n\nRocketChat.models.Rooms.updateLivechatDataByToken = function(token, key, value) {\n\tconst query = {\n\t\t'v.token': token\n\t};\n\n\tconst update = {\n\t\t$set: {\n\t\t\t[`livechatData.${key}`]: value\n\t\t}\n\t};\n\n\treturn this.update(query, update);\n};\n\nRocketChat.models.Rooms.findLivechat = function(offset = 0, limit = 20) {\n\tconst query = {\n\t\tt: 'l'\n\t};\n\n\treturn this.find(query, { sort: { ts: - 1 }, offset: offset, limit: limit });\n};\n\nRocketChat.models.Rooms.findLivechatByCode = function(code, fields) {\n\tconst query = {\n\t\tt: 'l',\n\t\tcode: parseInt(code)\n\t};\n\n\tlet options = {};\n\n\tif (fields) {\n\t\toptions.fields = fields;\n\t}\n\n\treturn this.find(query, options);\n};\n\n/**\n * Get the next visitor name\n * @return {string} The next visitor name\n */\nRocketChat.models.Rooms.getNextLivechatRoomCode = function() {\n\tconst settingsRaw = RocketChat.models.Settings.model.rawCollection();\n\tconst findAndModify = Meteor.wrapAsync(settingsRaw.findAndModify, settingsRaw);\n\n\tconst query = {\n\t\t_id: 'Livechat_Room_Count'\n\t};\n\n\tconst update = {\n\t\t$inc: {\n\t\t\tvalue: 1\n\t\t}\n\t};\n\n\tconst livechatCount = findAndModify(query, null, update);\n\n\treturn livechatCount.value;\n};\n\nRocketChat.models.Rooms.findOpenByVisitorToken = function(visitorToken, options) {\n\tconst query = {\n\t\topen: true,\n\t\t'v.token': visitorToken\n\t};\n\n\treturn this.find(query, options);\n};\n\nRocketChat.models.Rooms.findByVisitorToken = function(visitorToken) {\n\tconst query = {\n\t\t'v.token': visitorToken\n\t};\n\n\treturn this.find(query);\n};\n\nRocketChat.models.Rooms.findByVisitorId = function(visitorId) {\n\tconst query = {\n\t\t'v._id': visitorId\n\t};\n\n\treturn this.find(query);\n};\n\nRocketChat.models.Rooms.setResponseByRoomId = function(roomId, response) {\n\treturn this.update({\n\t\t_id: roomId\n\t}, {\n\t\t$set: {\n\t\t\tresponseBy: {\n\t\t\t\t_id: response.user._id,\n\t\t\t\tusername: response.user.username\n\t\t\t},\n\t\t\tresponseDate: response.responseDate,\n\t\t\tresponseTime: response.responseTime\n\t\t},\n\t\t$unset: {\n\t\t\twaitingResponse: 1\n\t\t}\n\t});\n};\n\nRocketChat.models.Rooms.closeByRoomId = function(roomId, closeInfo) {\n\treturn this.update({\n\t\t_id: roomId\n\t}, {\n\t\t$set: {\n\t\t\tclosedBy: {\n\t\t\t\t_id: closeInfo.user._id,\n\t\t\t\tusername: closeInfo.user.username\n\t\t\t},\n\t\t\tclosedAt: closeInfo.closedAt,\n\t\t\tchatDuration: closeInfo.chatDuration\n\t\t},\n\t\t$unset: {\n\t\t\topen: 1\n\t\t}\n\t});\n};\n\nRocketChat.models.Rooms.setLabelByRoomId = function(roomId, label) {\n\treturn this.update({ _id: roomId }, { $set: { label: label } });\n};\n\nRocketChat.models.Rooms.findOpenByAgent = function(userId) {\n\tconst query = {\n\t\topen: true,\n\t\t'servedBy._id': userId\n\t};\n\n\treturn this.find(query);\n};\n\nRocketChat.models.Rooms.changeAgentByRoomId = function(roomId, newUsernames, newAgent) {\n\tconst query = {\n\t\t_id: roomId\n\t};\n\tconst update = {\n\t\t$set: {\n\t\t\tusernames: newUsernames,\n\t\t\tservedBy: {\n\t\t\t\t_id: newAgent.agentId,\n\t\t\t\tusername: newAgent.username\n\t\t\t}\n\t\t}\n\t};\n\n\tthis.update(query, update);\n};\n","class LivechatExternalMessage extends RocketChat.models._Base {\n\tconstructor() {\n\t\tsuper();\n\t\tthis._initModel('livechat_external_message');\n\t}\n\n\t// FIND\n\tfindByRoomId(roomId, sort = { ts: -1 }) {\n\t\tconst query = { rid: roomId };\n\n\t\treturn this.find(query, { sort: sort });\n\t}\n}\n\nRocketChat.models.LivechatExternalMessage = new LivechatExternalMessage();\n","/**\n * Livechat Custom Fields model\n */\nclass LivechatCustomField extends RocketChat.models._Base {\n\tconstructor() {\n\t\tsuper();\n\t\tthis._initModel('livechat_custom_field');\n\t}\n\n\t// FIND\n\tfindOneById(_id, options) {\n\t\tconst query = { _id: _id };\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\tcreateOrUpdateCustomField(_id, field, label, scope, visibility, extraData) {\n\t\tvar record = {\n\t\t\tlabel: label,\n\t\t\tscope: scope,\n\t\t\tvisibility: visibility\n\t\t};\n\n\t\t_.extend(record, extraData);\n\n\t\tif (_id) {\n\t\t\tthis.update({ _id: _id }, { $set: record });\n\t\t} else {\n\t\t\trecord._id = field;\n\t\t\t_id = this.insert(record);\n\t\t}\n\n\t\treturn record;\n\t}\n\n\t// REMOVE\n\tremoveById(_id) {\n\t\tconst query = { _id: _id };\n\n\t\treturn this.remove(query);\n\t}\n}\n\nRocketChat.models.LivechatCustomField = new LivechatCustomField();\n","/**\n * Livechat Department model\n */\nclass LivechatDepartment extends RocketChat.models._Base {\n\tconstructor() {\n\t\tsuper();\n\t\tthis._initModel('livechat_department');\n\t}\n\n\t// FIND\n\tfindOneById(_id, options) {\n\t\tconst query = { _id: _id };\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\tfindByDepartmentId(_id, options) {\n\t\tconst query = { _id: _id };\n\n\t\treturn this.find(query, options);\n\t}\n\n\tcreateOrUpdateDepartment(_id, enabled, name, description, agents, extraData) {\n\t\tagents = [].concat(agents);\n\n\t\tvar record = {\n\t\t\tenabled: enabled,\n\t\t\tname: name,\n\t\t\tdescription: description,\n\t\t\tnumAgents: agents.length\n\t\t};\n\n\t\t_.extend(record, extraData);\n\n\t\tif (_id) {\n\t\t\tthis.update({ _id: _id }, { $set: record });\n\t\t} else {\n\t\t\t_id = this.insert(record);\n\t\t}\n\n\t\tvar savedAgents = _.pluck(RocketChat.models.LivechatDepartmentAgents.findByDepartmentId(_id).fetch(), 'agentId');\n\t\tvar agentsToSave = _.pluck(agents, 'agentId');\n\n\t\t// remove other agents\n\t\t_.difference(savedAgents, agentsToSave).forEach((agentId) => {\n\t\t\tRocketChat.models.LivechatDepartmentAgents.removeByDepartmentIdAndAgentId(_id, agentId);\n\t\t});\n\n\t\tagents.forEach((agent) => {\n\t\t\tRocketChat.models.LivechatDepartmentAgents.saveAgent({\n\t\t\t\tagentId: agent.agentId,\n\t\t\t\tdepartmentId: _id,\n\t\t\t\tusername: agent.username,\n\t\t\t\tcount: agent.count ? parseInt(agent.count) : 0,\n\t\t\t\torder: agent.order ? parseInt(agent.order) : 0\n\t\t\t});\n\t\t});\n\n\t\treturn _.extend(record, { _id: _id });\n\t}\n\n\t// REMOVE\n\tremoveById(_id) {\n\t\tconst query = { _id: _id };\n\n\t\treturn this.remove(query);\n\t}\n\n\tfindEnabledWithAgents() {\n\t\tvar query = {\n\t\t\tnumAgents: { $gt: 0 },\n\t\t\tenabled: true\n\t\t};\n\t\treturn this.find(query);\n\t}\n}\n\nRocketChat.models.LivechatDepartment = new LivechatDepartment();\n","/**\n * Livechat Department model\n */\nclass LivechatDepartmentAgents extends RocketChat.models._Base {\n\tconstructor() {\n\t\tsuper();\n\t\tthis._initModel('livechat_department_agents');\n\t}\n\n\tfindByDepartmentId(departmentId) {\n\t\treturn this.find({ departmentId: departmentId });\n\t}\n\n\tsaveAgent(agent) {\n\t\treturn this.upsert({\n\t\t\tagentId: agent.agentId,\n\t\t\tdepartmentId: agent.departmentId\n\t\t}, {\n\t\t\t$set: {\n\t\t\t\tusername: agent.username,\n\t\t\t\tcount: parseInt(agent.count),\n\t\t\t\torder: parseInt(agent.order)\n\t\t\t}\n\t\t});\n\t}\n\n\tremoveByDepartmentIdAndAgentId(departmentId, agentId) {\n\t\tthis.remove({ departmentId: departmentId, agentId: agentId });\n\t}\n\n\tgetNextAgentForDepartment(departmentId) {\n\t\tvar agents = this.findByDepartmentId(departmentId).fetch();\n\n\t\tif (agents.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar onlineUsers = RocketChat.models.Users.findOnlineUserFromList(_.pluck(agents, 'username'));\n\n\t\tvar onlineUsernames = _.pluck(onlineUsers.fetch(), 'username');\n\n\t\tvar query = {\n\t\t\tdepartmentId: departmentId,\n\t\t\tusername: {\n\t\t\t\t$in: onlineUsernames\n\t\t\t}\n\t\t};\n\n\t\tvar sort = {\n\t\t\tcount: 1,\n\t\t\torder: 1,\n\t\t\tusername: 1\n\t\t};\n\t\tvar update = {\n\t\t\t$inc: {\n\t\t\t\tcount: 1\n\t\t\t}\n\t\t};\n\n\t\tvar collectionObj = this.model.rawCollection();\n\t\tvar findAndModify = Meteor.wrapAsync(collectionObj.findAndModify, collectionObj);\n\n\t\tvar agent = findAndModify(query, sort, update);\n\t\tif (agent) {\n\t\t\treturn {\n\t\t\t\tagentId: agent.agentId,\n\t\t\t\tusername: agent.username\n\t\t\t};\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tgetOnlineForDepartment(departmentId) {\n\t\tvar agents = this.findByDepartmentId(departmentId).fetch();\n\n\t\tif (agents.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar onlineUsers = RocketChat.models.Users.findOnlineUserFromList(_.pluck(agents, 'username'));\n\n\t\tvar onlineUsernames = _.pluck(onlineUsers.fetch(), 'username');\n\n\t\tvar query = {\n\t\t\tdepartmentId: departmentId,\n\t\t\tusername: {\n\t\t\t\t$in: onlineUsernames\n\t\t\t}\n\t\t};\n\n\t\tvar depAgents = this.find(query);\n\n\t\tif (depAgents) {\n\t\t\treturn depAgents;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tfindUsersInQueue(usersList) {\n\t\tlet query = {};\n\n\t\tif (!_.isEmpty(usersList)) {\n\t\t\tquery.username = {\n\t\t\t\t$in: usersList\n\t\t\t};\n\t\t}\n\n\t\tlet options = {\n\t\t\tsort: {\n\t\t\t\tdepartmentId: 1,\n\t\t\t\tcount: 1,\n\t\t\t\torder: 1,\n\t\t\t\tusername: 1\n\t\t\t}\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n}\n\nRocketChat.models.LivechatDepartmentAgents = new LivechatDepartmentAgents();\n","/**\n * Livechat Page Visited model\n */\nclass LivechatPageVisited extends RocketChat.models._Base {\n\tconstructor() {\n\t\tsuper();\n\t\tthis._initModel('livechat_page_visited');\n\n\t\tthis.tryEnsureIndex({ 'token': 1 });\n\t\tthis.tryEnsureIndex({ 'ts': 1 });\n\n\t\t// keep history for 1 month if the visitor does not register\n\t\tthis.tryEnsureIndex({ 'expireAt': 1 }, { sparse: 1, expireAfterSeconds: 0 });\n\t}\n\n\tsaveByToken(token, pageInfo) {\n\t\t// keep history of unregistered visitors for 1 month\n\t\tvar keepHistoryMiliseconds = 2592000000;\n\n\t\treturn this.insert({\n\t\t\ttoken: token,\n\t\t\tpage: pageInfo,\n\t\t\tts: new Date(),\n\t\t\texpireAt: new Date().getTime() + keepHistoryMiliseconds\n\t\t});\n\t}\n\n\tfindByToken(token) {\n\t\treturn this.find({ token: token }, { sort : { ts: -1 }, limit: 20 });\n\t}\n\n\tkeepHistoryForToken(token) {\n\t\treturn this.update({\n\t\t\ttoken: token,\n\t\t\texpireAt: {\n\t\t\t\t$exists: true\n\t\t\t}\n\t\t}, {\n\t\t\t$unset: {\n\t\t\t\texpireAt: 1\n\t\t\t}\n\t\t}, {\n\t\t\tmulti: true\n\t\t});\n\t}\n}\n\nRocketChat.models.LivechatPageVisited = new LivechatPageVisited();\n","/**\n * Livechat Trigger model\n */\nclass LivechatTrigger extends RocketChat.models._Base {\n\tconstructor() {\n\t\tsuper();\n\t\tthis._initModel('livechat_trigger');\n\t}\n\n\t// FIND\n\tsave(data) {\n\t\tconst trigger = this.findOne();\n\n\t\tif (trigger) {\n\t\t\treturn this.update({ _id: trigger._id }, { $set: data });\n\t\t} else {\n\t\t\treturn this.insert(data);\n\t\t}\n\t}\n\n\tremoveAll() {\n\t\tthis.remove({});\n\t}\n}\n\nRocketChat.models.LivechatTrigger = new LivechatTrigger();\n","Meteor.startup(function() {\n\tRocketChat.models.Rooms.tryEnsureIndex({ code: 1 });\n\tRocketChat.models.Rooms.tryEnsureIndex({ open: 1 }, { sparse: 1 });\n});\n","class LivechatInquiry extends RocketChat.models._Base {\n\tconstructor() {\n\t\tsuper();\n\t\tthis._initModel('livechat_inquiry');\n\n\t\tthis.tryEnsureIndex({ 'rid': 1 }); // room id corresponding to this inquiry\n\t\tthis.tryEnsureIndex({ 'name': 1 }); // name of the inquiry (client name for now)\n\t\tthis.tryEnsureIndex({ 'message': 1 }); // message sent by the client\n\t\tthis.tryEnsureIndex({ 'ts': 1 }); // timestamp\n\t\tthis.tryEnsureIndex({ 'code': 1 }); // (for routing)\n\t\tthis.tryEnsureIndex({ 'agents': 1}); // Id's of the agents who can see the inquiry (handle departments)\n\t\tthis.tryEnsureIndex({ 'status': 1}); // 'open', 'taken'\n\t}\n\n\tfindOneById(inquiryId) {\n\t\treturn this.findOne({ _id: inquiryId });\n\t}\n\n\t/*\n\t * mark the inquiry as taken\n\t */\n\ttakeInquiry(inquiryId) {\n\t\tthis.update({\n\t\t\t'_id': inquiryId\n\t\t}, {\n\t\t\t$set: { status: 'taken' }\n\t\t});\n\t}\n\n\t/*\n\t * mark inquiry as open\n\t */\n\topenInquiry(inquiryId) {\n\t\tthis.update({\n\t\t\t'_id': inquiryId\n\t\t}, {\n\t\t\t$set: { status: 'open' }\n\t\t});\n\t}\n\n\t/*\n\t * return the status of the inquiry (open or taken)\n\t */\n\tgetStatus(inquiryId) {\n\t\treturn this.findOne({'_id': inquiryId}).status;\n\t}\n}\n\nRocketChat.models.LivechatInquiry = new LivechatInquiry();\n","RocketChat.Livechat = {\n\thistoryMonitorType: 'url',\n\n\tlogger: new Logger('Livechat', {\n\t\tsections: {\n\t\t\twebhook: 'Webhook'\n\t\t}\n\t}),\n\n\tgetNextAgent(department) {\n\t\tif (department) {\n\t\t\treturn RocketChat.models.LivechatDepartmentAgents.getNextAgentForDepartment(department);\n\t\t} else {\n\t\t\treturn RocketChat.models.Users.getNextAgent();\n\t\t}\n\t},\n\tgetAgents(department) {\n\t\tif (department) {\n\t\t\treturn RocketChat.models.LivechatDepartmentAgents.findByDepartmentId(department);\n\t\t} else {\n\t\t\treturn RocketChat.models.Users.findAgents();\n\t\t}\n\t},\n\tgetOnlineAgents(department) {\n\t\tif (department) {\n\t\t\treturn RocketChat.models.LivechatDepartmentAgents.getOnlineForDepartment(department);\n\t\t} else {\n\t\t\treturn RocketChat.models.Users.findOnlineAgents();\n\t\t}\n\t},\n\tsendMessage({ guest, message, roomInfo }) {\n\t\tvar room = RocketChat.models.Rooms.findOneById(message.rid);\n\t\tvar newRoom = false;\n\n\t\tif (room && !room.open) {\n\t\t\tmessage.rid = Random.id();\n\t\t\troom = null;\n\t\t}\n\n\t\tif (room == null) {\n\t\t\t// if no department selected verify if there is at least one active and choose one randomly\n\t\t\tif (!guest.department) {\n\t\t\t\tvar departments = RocketChat.models.LivechatDepartment.findEnabledWithAgents();\n\t\t\t\tif (departments.count() > 0) {\n\t\t\t\t\tguest.department = departments.fetch()[0]._id;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// delegate room creation to QueueMethods\n\t\t\tconst routingMethod = RocketChat.settings.get('Livechat_Routing_Method');\n\t\t\troom = RocketChat.QueueMethods[routingMethod](guest, message, roomInfo);\n\n\t\t\tnewRoom = true;\n\t\t} else {\n\t\t\troom = Meteor.call('canAccessRoom', message.rid, guest._id);\n\t\t}\n\t\tif (!room) {\n\t\t\tthrow new Meteor.Error('cannot-acess-room');\n\t\t}\n\t\treturn _.extend(RocketChat.sendMessage(guest, message, room), { newRoom: newRoom });\n\t},\n\tregisterGuest({ token, name, email, department, phone, loginToken, username } = {}) {\n\t\tcheck(token, String);\n\n\t\tconst user = RocketChat.models.Users.getVisitorByToken(token, { fields: { _id: 1 } });\n\n\t\tif (user) {\n\t\t\tthrow new Meteor.Error('token-already-exists', 'Token already exists');\n\t\t}\n\n\t\tif (!username) {\n\t\t\tusername = RocketChat.models.Users.getNextVisitorUsername();\n\t\t}\n\n\t\tlet updateUser = {\n\t\t\t$set: {\n\t\t\t\tprofile: {\n\t\t\t\t\tguest: true,\n\t\t\t\t\ttoken: token\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tvar existingUser = null;\n\n\t\tvar userId;\n\n\t\tif (s.trim(email) !== '' && (existingUser = RocketChat.models.Users.findOneByEmailAddress(email))) {\n\t\t\tif (existingUser.type !== 'visitor') {\n\t\t\t\tthrow new Meteor.Error('error-invalid-user', 'This email belongs to a registered user.');\n\t\t\t}\n\n\t\t\tupdateUser.$addToSet = {\n\t\t\t\tglobalRoles: 'livechat-guest'\n\t\t\t};\n\n\t\t\tif (loginToken) {\n\t\t\t\tupdateUser.$addToSet['services.resume.loginTokens'] = loginToken;\n\t\t\t}\n\n\t\t\tuserId = existingUser._id;\n\t\t} else {\n\t\t\tupdateUser.$set.name = name;\n\n\t\t\tvar userData = {\n\t\t\t\tusername: username,\n\t\t\t\tglobalRoles: ['livechat-guest'],\n\t\t\t\tdepartment: department,\n\t\t\t\ttype: 'visitor'\n\t\t\t};\n\n\t\t\tif (this.connection) {\n\t\t\t\tuserData.userAgent = this.connection.httpHeaders['user-agent'];\n\t\t\t\tuserData.ip = this.connection.httpHeaders['x-real-ip'] || this.connection.clientAddress;\n\t\t\t\tuserData.host = this.connection.httpHeaders.host;\n\t\t\t}\n\n\t\t\tuserId = Accounts.insertUserDoc({}, userData);\n\n\t\t\tif (loginToken) {\n\t\t\t\tupdateUser.$set.services = {\n\t\t\t\t\tresume: {\n\t\t\t\t\t\tloginTokens: [ loginToken ]\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tif (phone) {\n\t\t\tupdateUser.$set.phone = [\n\t\t\t\t{ phoneNumber: phone.number }\n\t\t\t];\n\t\t}\n\n\t\tif (email && email.trim() !== '') {\n\t\t\tupdateUser.$set.emails = [\n\t\t\t\t{ address: email }\n\t\t\t];\n\t\t}\n\n\t\tMeteor.users.update(userId, updateUser);\n\n\t\treturn userId;\n\t},\n\n\tsaveGuest({ _id, name, email, phone }) {\n\t\tlet updateData = {};\n\n\t\tif (name) {\n\t\t\tupdateData.name = name;\n\t\t}\n\t\tif (email) {\n\t\t\tupdateData.email = email;\n\t\t}\n\t\tif (phone) {\n\t\t\tupdateData.phone = phone;\n\t\t}\n\t\treturn RocketChat.models.Users.saveUserById(_id, updateData);\n\t},\n\n\tcloseRoom({ user, room, comment }) {\n\t\tlet now = new Date();\n\t\tRocketChat.models.Rooms.closeByRoomId(room._id, {\n\t\t\tuser: {\n\t\t\t\t_id: user._id,\n\t\t\t\tusername: user.username\n\t\t\t},\n\t\t\tclosedAt: now,\n\t\t\tchatDuration: (now.getTime() - room.ts) / 1000\n\t\t});\n\n\t\tconst message = {\n\t\t\tt: 'livechat-close',\n\t\t\tmsg: comment,\n\t\t\tgroupable: false\n\t\t};\n\n\t\tRocketChat.sendMessage(user, message, room);\n\n\t\tRocketChat.models.Subscriptions.hideByRoomIdAndUserId(room._id, user._id);\n\n\t\tMeteor.defer(() => {\n\t\t\tRocketChat.callbacks.run('closeLivechat', room);\n\t\t});\n\n\t\treturn true;\n\t},\n\n\tgetInitSettings() {\n\t\tlet settings = {};\n\n\t\tRocketChat.models.Settings.findNotHiddenPublic([\n\t\t\t'Livechat_title',\n\t\t\t'Livechat_title_color',\n\t\t\t'Livechat_enabled',\n\t\t\t'Livechat_registration_form',\n\t\t\t'Livechat_offline_title',\n\t\t\t'Livechat_offline_title_color',\n\t\t\t'Livechat_offline_message',\n\t\t\t'Livechat_offline_success_message',\n\t\t\t'Livechat_offline_form_unavailable',\n\t\t\t'Livechat_display_offline_form',\n\t\t\t'Language'\n\t\t]).forEach((setting) => {\n\t\t\tsettings[setting._id] = setting.value;\n\t\t});\n\n\t\treturn settings;\n\t},\n\n\tsaveRoomInfo(roomData, guestData) {\n\t\tif (!RocketChat.models.Rooms.saveRoomById(roomData._id, roomData)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!_.isEmpty(guestData.name)) {\n\t\t\treturn RocketChat.models.Rooms.setLabelByRoomId(roomData._id, guestData.name) && RocketChat.models.Subscriptions.updateNameByRoomId(roomData._id, guestData.name);\n\t\t}\n\t},\n\n\tforwardOpenChats(userId) {\n\t\tRocketChat.models.Rooms.findOpenByAgent(userId).forEach((room) => {\n\t\t\tconst guest = RocketChat.models.Users.findOneById(room.v._id);\n\t\t\tthis.transfer(room, guest, { departmentId: guest.department });\n\t\t});\n\t},\n\n\tsavePageHistory(token, pageInfo) {\n\t\tif (pageInfo.change === RocketChat.Livechat.historyMonitorType) {\n\t\t\treturn RocketChat.models.LivechatPageVisited.saveByToken(token, pageInfo);\n\t\t}\n\n\t\treturn;\n\t},\n\n\ttransfer(room, guest, transferData) {\n\t\tlet agent;\n\n\t\tif (transferData.userId) {\n\t\t\tconst user = RocketChat.models.Users.findOneById(transferData.userId);\n\t\t\tagent = {\n\t\t\t\tagentId: user._id,\n\t\t\t\tusername: user.username\n\t\t\t};\n\t\t} else {\n\t\t\tagent = RocketChat.Livechat.getNextAgent(transferData.departmentId);\n\t\t}\n\n\t\tif (agent && agent.agentId !== room.servedBy._id) {\n\t\t\troom.usernames = _.without(room.usernames, room.servedBy.username).concat(agent.username);\n\n\t\t\tRocketChat.models.Rooms.changeAgentByRoomId(room._id, room.usernames, agent);\n\n\t\t\tlet subscriptionData = {\n\t\t\t\trid: room._id,\n\t\t\t\tname: guest.name || guest.username,\n\t\t\t\talert: true,\n\t\t\t\topen: true,\n\t\t\t\tunread: 1,\n\t\t\t\tcode: room.code,\n\t\t\t\tu: {\n\t\t\t\t\t_id: agent.agentId,\n\t\t\t\t\tusername: agent.username\n\t\t\t\t},\n\t\t\t\tt: 'l',\n\t\t\t\tdesktopNotifications: 'all',\n\t\t\t\tmobilePushNotifications: 'all',\n\t\t\t\temailNotifications: 'all'\n\t\t\t};\n\t\t\tRocketChat.models.Subscriptions.removeByRoomIdAndUserId(room._id, room.servedBy._id);\n\n\t\t\tRocketChat.models.Subscriptions.insert(subscriptionData);\n\n\t\t\tRocketChat.models.Messages.createUserLeaveWithRoomIdAndUser(room._id, { _id: room.servedBy._id, username: room.servedBy.username });\n\t\t\tRocketChat.models.Messages.createUserJoinWithRoomIdAndUser(room._id, { _id: agent.agentId, username: agent.username });\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n};\n\nRocketChat.settings.get('Livechat_history_monitor_type', (key, value) => {\n\tRocketChat.Livechat.historyMonitorType = value;\n});\n","RocketChat.QueueMethods = {\n\t/* Least Amount Queuing method:\n\t *\n\t * default method where the agent with the least number\n\t * of open chats is paired with the incoming livechat\n\t */\n\t'Least_Amount' : function(guest, message, roomInfo) {\n\t\tconst agent = RocketChat.Livechat.getNextAgent(guest.department);\n\t\tif (!agent) {\n\t\t\tthrow new Meteor.Error('no-agent-online', 'Sorry, no online agents');\n\t\t}\n\n\t\tconst roomCode = RocketChat.models.Rooms.getNextLivechatRoomCode();\n\n\t\tconst room = _.extend({\n\t\t\t_id: message.rid,\n\t\t\tmsgs: 1,\n\t\t\tlm: new Date(),\n\t\t\tcode: roomCode,\n\t\t\tlabel: guest.name || guest.username,\n\t\t\tusernames: [agent.username, guest.username],\n\t\t\tt: 'l',\n\t\t\tts: new Date(),\n\t\t\tv: {\n\t\t\t\t_id: guest._id,\n\t\t\t\ttoken: message.token\n\t\t\t},\n\t\t\tservedBy: {\n\t\t\t\t_id: agent.agentId,\n\t\t\t\tusername: agent.username\n\t\t\t},\n\t\t\tcl: false,\n\t\t\topen: true,\n\t\t\twaitingResponse: true\n\t\t}, roomInfo);\n\t\tlet subscriptionData = {\n\t\t\trid: message.rid,\n\t\t\tname: guest.name || guest.username,\n\t\t\talert: true,\n\t\t\topen: true,\n\t\t\tunread: 1,\n\t\t\tcode: roomCode,\n\t\t\tu: {\n\t\t\t\t_id: agent.agentId,\n\t\t\t\tusername: agent.username\n\t\t\t},\n\t\t\tt: 'l',\n\t\t\tdesktopNotifications: 'all',\n\t\t\tmobilePushNotifications: 'all',\n\t\t\temailNotifications: 'all'\n\t\t};\n\n\t\tRocketChat.models.Rooms.insert(room);\n\t\tRocketChat.models.Subscriptions.insert(subscriptionData);\n\n\t\treturn room;\n\t},\n\t/* Guest Pool Queuing Method:\n\t *\n\t * An incomming livechat is created as an Inquiry\n\t * which is picked up from an agent.\n\t * An Inquiry is visible to all agents (TODO: in the correct department)\n     *\n\t * A room is still created with the initial message, but it is occupied by\n\t * only the client until paired with an agent\n\t */\n\t'Guest_Pool' : function(guest, message, roomInfo) {\n\t\tlet agents = RocketChat.Livechat.getOnlineAgents(guest.department);\n\n\t\tif (agents.count() === 0 && RocketChat.settings.get('Livechat_guest_pool_with_no_agents')) {\n\t\t\tagents = RocketChat.Livechat.getAgents(guest.department);\n\t\t}\n\n\t\tif (agents.count() === 0) {\n\t\t\tthrow new Meteor.Error('no-agent-online', 'Sorry, no online agents');\n\t\t}\n\n\t\tconst roomCode = RocketChat.models.Rooms.getNextLivechatRoomCode();\n\n\t\tconst agentIds = [];\n\n\t\tagents.forEach((agent) => {\n\t\t\tif (guest.department) {\n\t\t\t\tagentIds.push(agent.agentId);\n\t\t\t} else {\n\t\t\t\tagentIds.push(agent._id);\n\t\t\t}\n\t\t});\n\n\t\tvar inquiry = {\n\t\t\trid: message.rid,\n\t\t\tmessage: message.msg,\n\t\t\tname: guest.name || guest.username,\n\t\t\tts: new Date(),\n\t\t\tcode: roomCode,\n\t\t\tdepartment: guest.department,\n\t\t\tagents: agentIds,\n\t\t\tstatus: 'open',\n\t\t\tt: 'l'\n\t\t};\n\t\tconst room = _.extend({\n\t\t\t_id: message.rid,\n\t\t\tmsgs: 1,\n\t\t\tlm: new Date(),\n\t\t\tcode: roomCode,\n\t\t\tlabel: guest.name || guest.username,\n\t\t\tusernames: [guest.username],\n\t\t\tt: 'l',\n\t\t\tts: new Date(),\n\t\t\tv: {\n\t\t\t\t_id: guest._id,\n\t\t\t\ttoken: message.token\n\t\t\t},\n\t\t\tcl: false,\n\t\t\topen: true,\n\t\t\twaitingResponse: true\n\t\t}, roomInfo);\n\t\tRocketChat.models.LivechatInquiry.insert(inquiry);\n\t\tRocketChat.models.Rooms.insert(room);\n\n\t\treturn room;\n\t}\n};\n","RocketChat.callbacks.add('afterSaveMessage', function(message, room) {\n\t// skips this callback if the message was edited\n\tif (message.editedAt) {\n\t\treturn message;\n\t}\n\n\tif (!RocketChat.SMS.enabled) {\n\t\treturn message;\n\t}\n\n\t// only send the sms by SMS if it is a livechat room with SMS set to true\n\tif (!(typeof room.t !== 'undefined' && room.t === 'l' && room.sms && room.v && room.v.token)) {\n\t\treturn message;\n\t}\n\n\t// if the message has a token, it was sent from the visitor, so ignore it\n\tif (message.token) {\n\t\treturn message;\n\t}\n\n\t// if the message has a type means it is a special message (like the closing comment), so skips\n\tif (message.t) {\n\t\treturn message;\n\t}\n\n\tconst SMSService = RocketChat.SMS.getService(RocketChat.settings.get('SMS_Service'));\n\n\tif (!SMSService) {\n\t\treturn message;\n\t}\n\n\tconst visitor = RocketChat.models.Users.getVisitorByToken(room.v.token);\n\n\tif (!visitor || !visitor.profile || !visitor.phone || visitor.phone.length === 0) {\n\t\treturn message;\n\t}\n\n\tSMSService.send(room.sms.from, visitor.phone[0].phoneNumber, message.msg);\n\n\treturn message;\n\n}, RocketChat.callbacks.priority.LOW, 'sendMessageBySms');\n","/* globals HTTP, SystemLogger */\n\nvar knowledgeEnabled = false;\nvar apiaiKey = '';\nvar apiaiLanguage = 'en';\nRocketChat.settings.get('Livechat_Knowledge_Enabled', function(key, value) {\n\tknowledgeEnabled = value;\n});\nRocketChat.settings.get('Livechat_Knowledge_Apiai_Key', function(key, value) {\n\tapiaiKey = value;\n});\nRocketChat.settings.get('Livechat_Knowledge_Apiai_Language', function(key, value) {\n\tapiaiLanguage = value;\n});\n\nRocketChat.callbacks.add('afterSaveMessage', function(message, room) {\n\t// skips this callback if the message was edited\n\tif (message.editedAt) {\n\t\treturn message;\n\t}\n\n\tif (!knowledgeEnabled) {\n\t\treturn message;\n\t}\n\n\tif (!(typeof room.t !== 'undefined' && room.t === 'l' && room.v && room.v.token)) {\n\t\treturn message;\n\t}\n\n\t// if the message hasn't a token, it was not sent by the visitor, so ignore it\n\tif (!message.token) {\n\t\treturn message;\n\t}\n\n\tMeteor.defer(() => {\n\t\ttry {\n\t\t\tconst response = HTTP.post('https://api.api.ai/api/query?v=20150910', {\n\t\t\t\tdata: {\n\t\t\t\t\tquery: message.msg,\n\t\t\t\t\tlang: apiaiLanguage\n\t\t\t\t},\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/json; charset=utf-8',\n\t\t\t\t\t'Authorization': 'Bearer ' + apiaiKey\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (response.data && response.data.status.code === 200 && !_.isEmpty(response.data.result.fulfillment.speech)) {\n\t\t\t\tRocketChat.models.LivechatExternalMessage.insert({\n\t\t\t\t\trid: message.rid,\n\t\t\t\t\tmsg: response.data.result.fulfillment.speech,\n\t\t\t\t\torig: message._id,\n\t\t\t\t\tts: new Date()\n\t\t\t\t});\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tSystemLogger.error('Error using Api.ai ->', e);\n\t\t}\n\t});\n\n\treturn message;\n}, RocketChat.callbacks.priority.LOW, 'externalWebHook');\n","/* globals UserPresenceMonitor */\n\nlet agentsHandler;\nlet monitorAgents = false;\nlet forwardChatTimeout = 60000;\n\nlet onlineAgents = {\n\tusers: {},\n\tqueue: {},\n\n\tadd(userId) {\n\t\tif (this.queue[userId]) {\n\t\t\tclearTimeout(this.queue[userId]);\n\t\t\tdelete this.queue[userId];\n\t\t}\n\t\tthis.users[userId] = 1;\n\t},\n\n\tremove(userId, callback) {\n\t\tif (this.queue[userId]) {\n\t\t\tclearTimeout(this.queue[userId]);\n\t\t}\n\t\tthis.queue[userId] = setTimeout(Meteor.bindEnvironment(() => {\n\t\t\tcallback();\n\n\t\t\tdelete this.users[userId];\n\t\t\tdelete this.queue[userId];\n\t\t}), forwardChatTimeout);\n\t},\n\n\texists(userId) {\n\t\treturn !!this.users[userId];\n\t}\n};\n\nRocketChat.settings.get('Livechat_forward_open_chats_timeout', function(key, value) {\n\tforwardChatTimeout = value * 1000;\n});\n\nRocketChat.settings.get('Livechat_forward_open_chats', function(key, value) {\n\tmonitorAgents = value;\n\tif (value) {\n\t\tif (!agentsHandler) {\n\t\t\tagentsHandler = RocketChat.models.Users.findOnlineAgents().observeChanges({\n\t\t\t\tadded(id) {\n\t\t\t\t\tonlineAgents.add(id);\n\t\t\t\t},\n\t\t\t\tchanged(id, fields) {\n\t\t\t\t\tif (fields.statusLivechat && fields.statusLivechat === 'not-available') {\n\t\t\t\t\t\tonlineAgents.remove(id, () => {\n\t\t\t\t\t\t\tRocketChat.Livechat.forwardOpenChats(id);\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tonlineAgents.add(id);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tremoved(id) {\n\t\t\t\t\tonlineAgents.remove(id, () => {\n\t\t\t\t\t\tRocketChat.Livechat.forwardOpenChats(id);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t} else if (agentsHandler) {\n\t\tagentsHandler.stop();\n\t\tagentsHandler = null;\n\t}\n});\n\nUserPresenceMonitor.onSetUserStatus((user, status, statusConnection) => {\n\tif (!monitorAgents) {\n\t\treturn;\n\t}\n\tif (onlineAgents.exists(user._id)) {\n\t\tif (statusConnection === 'offline' || user.statusLivechat === 'not-available') {\n\t\t\tonlineAgents.remove(user._id, () => {\n\t\t\t\tRocketChat.Livechat.forwardOpenChats(user._id);\n\t\t\t});\n\t\t}\n\t}\n});\n","/* globals HTTP */\nlet sendOnCloseLivechat = false;\nlet sendOnOfflineMessage = false;\nlet webhookURL = '';\nlet secretToken = '';\n\nRocketChat.settings.get('Livechat_webhook_on_close', function(key, value) {\n\tsendOnCloseLivechat = value;\n});\n\nRocketChat.settings.get('Livechat_webhook_on_offline_msg', function(key, value) {\n\tsendOnOfflineMessage = value;\n});\n\nRocketChat.settings.get('Livechat_webhookUrl', function(key, value) {\n\twebhookURL = value;\n});\n\nRocketChat.settings.get('Livechat_secret_token', function(key, value) {\n\tsecretToken = value;\n});\n\nconst sendRequest = (postData, trying = 1) => {\n\ttry {\n\t\tlet options = {\n\t\t\theaders: {\n\t\t\t\t'X-RocketChat-Livechat-Token': secretToken\n\t\t\t},\n\t\t\tdata: postData\n\t\t};\n\t\tHTTP.post(webhookURL, options);\n\t} catch (e) {\n\t\tRocketChat.Livechat.logger.webhook.error('Response error on ' + trying + ' try ->', e);\n\t\t// try 10 times after 10 seconds each\n\t\tif (trying < 10) {\n\t\t\tRocketChat.Livechat.logger.webhook.warn('Will try again in 10 seconds ...');\n\t\t\ttrying++;\n\t\t\tsetTimeout(Meteor.bindEnvironment(() => {\n\t\t\t\tsendRequest(postData, trying);\n\t\t\t}), 10000);\n\t\t}\n\t}\n};\n\nRocketChat.callbacks.add('closeLivechat', (room) => {\n\tif (!sendOnCloseLivechat) {\n\t\treturn room;\n\t}\n\n\tconst visitor = RocketChat.models.Users.findOneById(room.v._id);\n\tconst agent = RocketChat.models.Users.findOneById(room.servedBy._id);\n\n\tconst ua = new UAParser();\n\tua.setUA(visitor.userAgent);\n\n\tlet postData = {\n\t\ttype: 'LivechatSession',\n\t\t_id: room._id,\n\t\tlabel: room.label,\n\t\ttopic: room.topic,\n\t\tcode: room.code,\n\t\tcreatedAt: room.ts,\n\t\tlastMessageAt: room.lm,\n\t\ttags: room.tags,\n\t\tcustomFields: room.livechatData,\n\t\tvisitor: {\n\t\t\t_id: visitor._id,\n\t\t\tname: visitor.name,\n\t\t\tusername: visitor.username,\n\t\t\temail: null,\n\t\t\tphone: null,\n\t\t\tdepartment: visitor.department,\n\t\t\tip: visitor.ip,\n\t\t\tos: ua.getOS().name && (ua.getOS().name + ' ' + ua.getOS().version),\n\t\t\tbrowser: ua.getBrowser().name && (ua.getBrowser().name + ' ' + ua.getBrowser().version),\n\t\t\tcustomFields: visitor.livechatData\n\t\t},\n\t\tagent: {\n\t\t\t_id: agent._id,\n\t\t\tusername: agent.username,\n\t\t\tname: agent.name,\n\t\t\temail: null\n\t\t},\n\t\tmessages: []\n\t};\n\n\tif (visitor.emails && visitor.emails.length > 0) {\n\t\tpostData.visitor.email = visitor.emails[0].address;\n\t}\n\tif (visitor.phone && visitor.phone.length > 0) {\n\t\tpostData.visitor.phone = visitor.phone[0].phoneNumber;\n\t}\n\n\tif (agent.emails && agent.emails.length > 0) {\n\t\tpostData.agent.email = agent.emails[0].address;\n\t}\n\n\tRocketChat.models.Messages.findVisibleByRoomId(room._id, { sort: { ts: 1 } }).forEach((message) => {\n\t\tif (message.t) {\n\t\t\treturn;\n\t\t}\n\t\tlet msg = {\n\t\t\tusername: message.u.username,\n\t\t\tmsg: message.msg,\n\t\t\tts: message.ts\n\t\t};\n\n\t\tif (message.u.username !== visitor.username) {\n\t\t\tmsg.agentId = message.u._id;\n\t\t}\n\t\tpostData.messages.push(msg);\n\t});\n\n\tsendRequest(postData);\n});\n\nRocketChat.callbacks.add('sendOfflineLivechatMessage', (data) => {\n\tif (!sendOnOfflineMessage) {\n\t\treturn data;\n\t}\n\n\tlet postData = {\n\t\ttype: 'LivechatOfflineMessage',\n\t\tsentAt: new Date(),\n\t\tvisitor: {\n\t\t\tname: data.name,\n\t\t\temail: data.email\n\t\t},\n\t\tmessage: data.message\n\t};\n\n\tsendRequest(postData);\n});\n","Meteor.publish('livechat:customFields', function(_id) {\n\tif (!this.userId) {\n\t\treturn this.error(new Meteor.Error('error-not-authorized', 'Not authorized', { publish: 'livechat:customFields' }));\n\t}\n\n\tif (!RocketChat.authz.hasPermission(this.userId, 'view-l-room')) {\n\t\treturn this.error(new Meteor.Error('error-not-authorized', 'Not authorized', { publish: 'livechat:customFields' }));\n\t}\n\n\tif (s.trim(_id)) {\n\t\treturn RocketChat.models.LivechatCustomField.find({ _id: _id });\n\t}\n\n\treturn RocketChat.models.LivechatCustomField.find();\n\n});\n","Meteor.publish('livechat:departmentAgents', function(departmentId) {\n\tif (!this.userId) {\n\t\treturn this.error(new Meteor.Error('error-not-authorized', 'Not authorized', { publish: 'livechat:departmentAgents' }));\n\t}\n\n\tif (!RocketChat.authz.hasPermission(this.userId, 'view-livechat-rooms')) {\n\t\treturn this.error(new Meteor.Error('error-not-authorized', 'Not authorized', { publish: 'livechat:departmentAgents' }));\n\t}\n\n\treturn RocketChat.models.LivechatDepartmentAgents.find({ departmentId: departmentId });\n});\n","Meteor.publish('livechat:externalMessages', function(roomId) {\n\treturn RocketChat.models.LivechatExternalMessage.findByRoomId(roomId);\n});\n","Meteor.publish('livechat:agents', function() {\n\tif (!this.userId) {\n\t\treturn this.error(new Meteor.Error('error-not-authorized', 'Not authorized', { publish: 'livechat:agents' }));\n\t}\n\n\tif (!RocketChat.authz.hasPermission(this.userId, 'view-l-room')) {\n\t\treturn this.error(new Meteor.Error('error-not-authorized', 'Not authorized', { publish: 'livechat:agents' }));\n\t}\n\n\tvar self = this;\n\n\tvar handle = RocketChat.authz.getUsersInRole('livechat-agent').observeChanges({\n\t\tadded(id, fields) {\n\t\t\tself.added('agentUsers', id, fields);\n\t\t},\n\t\tchanged(id, fields) {\n\t\t\tself.changed('agentUsers', id, fields);\n\t\t},\n\t\tremoved(id) {\n\t\t\tself.removed('agentUsers', id);\n\t\t}\n\t});\n\n\tself.ready();\n\n\tself.onStop(function() {\n\t\thandle.stop();\n\t});\n});\n","Meteor.publish('livechat:departments', function(_id) {\n\tif (!this.userId) {\n\t\treturn this.error(new Meteor.Error('error-not-authorized', 'Not authorized', { publish: 'livechat:agents' }));\n\t}\n\n\tif (!RocketChat.authz.hasPermission(this.userId, 'view-l-room')) {\n\t\treturn this.error(new Meteor.Error('error-not-authorized', 'Not authorized', { publish: 'livechat:agents' }));\n\t}\n\n\tif (_id !== undefined) {\n\t\treturn RocketChat.models.LivechatDepartment.findByDepartmentId(_id);\n\t} else {\n\t\treturn RocketChat.models.LivechatDepartment.find();\n\t}\n\n});\n","Meteor.publish('livechat:integration', function() {\n\tif (!this.userId) {\n\t\treturn this.error(new Meteor.Error('error-not-authorized', 'Not authorized', { publish: 'livechat:integration' }));\n\t}\n\n\tif (!RocketChat.authz.hasPermission(this.userId, 'view-livechat-manager')) {\n\t\treturn this.error(new Meteor.Error('error-not-authorized', 'Not authorized', { publish: 'livechat:integration' }));\n\t}\n\n\tvar self = this;\n\n\tvar handle = RocketChat.models.Settings.findByIds(['Livechat_webhookUrl', 'Livechat_secret_token', 'Livechat_webhook_on_close', 'Livechat_webhook_on_offline_msg']).observeChanges({\n\t\tadded(id, fields) {\n\t\t\tself.added('livechatIntegration', id, fields);\n\t\t},\n\t\tchanged(id, fields) {\n\t\t\tself.changed('livechatIntegration', id, fields);\n\t\t},\n\t\tremoved(id) {\n\t\t\tself.removed('livechatIntegration', id);\n\t\t}\n\t});\n\n\tself.ready();\n\n\tself.onStop(function() {\n\t\thandle.stop();\n\t});\n});\n","Meteor.publish('livechat:managers', function() {\n\tif (!this.userId) {\n\t\treturn this.error(new Meteor.Error('error-not-authorized', 'Not authorized', { publish: 'livechat:managers' }));\n\t}\n\n\tif (!RocketChat.authz.hasPermission(this.userId, 'view-livechat-rooms')) {\n\t\treturn this.error(new Meteor.Error('error-not-authorized', 'Not authorized', { publish: 'livechat:managers' }));\n\t}\n\n\tvar self = this;\n\n\tvar handle = RocketChat.authz.getUsersInRole('livechat-manager').observeChanges({\n\t\tadded(id, fields) {\n\t\t\tself.added('managerUsers', id, fields);\n\t\t},\n\t\tchanged(id, fields) {\n\t\t\tself.changed('managerUsers', id, fields);\n\t\t},\n\t\tremoved(id) {\n\t\t\tself.removed('managerUsers', id);\n\t\t}\n\t});\n\n\tself.ready();\n\n\tself.onStop(function() {\n\t\thandle.stop();\n\t});\n});\n","Meteor.publish('livechat:rooms', function(offset = 0, limit = 20) {\n\tif (!this.userId) {\n\t\treturn this.error(new Meteor.Error('error-not-authorized', 'Not authorized', { publish: 'livechat:rooms' }));\n\t}\n\n\tif (!RocketChat.authz.hasPermission(this.userId, 'view-livechat-rooms')) {\n\t\treturn this.error(new Meteor.Error('error-not-authorized', 'Not authorized', { publish: 'livechat:rooms' }));\n\t}\n\n\treturn RocketChat.models.Rooms.findLivechat(offset, limit);\n});\n","Meteor.publish('livechat:queue', function() {\n\tif (!this.userId) {\n\t\treturn this.error(new Meteor.Error('error-not-authorized', 'Not authorized', { publish: 'livechat:queue' }));\n\t}\n\n\tif (!RocketChat.authz.hasPermission(this.userId, 'view-l-room')) {\n\t\treturn this.error(new Meteor.Error('error-not-authorized', 'Not authorized', { publish: 'livechat:queue' }));\n\t}\n\n\t// let sort = { count: 1, sort: 1, username: 1 };\n\t// let onlineUsers = {};\n\n\t// let handleUsers = RocketChat.models.Users.findOnlineAgents().observeChanges({\n\t// \tadded(id, fields) {\n\t// \t\tonlineUsers[fields.username] = 1;\n\t// \t\t// this.added('livechatQueueUser', id, fields);\n\t// \t},\n\t// \tchanged(id, fields) {\n\t// \t\tonlineUsers[fields.username] = 1;\n\t// \t\t// this.changed('livechatQueueUser', id, fields);\n\t// \t},\n\t// \tremoved(id) {\n\t// \t\tthis.removed('livechatQueueUser', id);\n\t// \t}\n\t// });\n\n\tlet self = this;\n\n\tlet handleDepts = RocketChat.models.LivechatDepartmentAgents.findUsersInQueue().observeChanges({\n\t\tadded(id, fields) {\n\t\t\tself.added('livechatQueueUser', id, fields);\n\t\t},\n\t\tchanged(id, fields) {\n\t\t\tself.changed('livechatQueueUser', id, fields);\n\t\t},\n\t\tremoved(id) {\n\t\t\tself.removed('livechatQueueUser', id);\n\t\t}\n\t});\n\n\tthis.ready();\n\n\tthis.onStop(() => {\n\t\t// handleUsers.stop();\n\t\thandleDepts.stop();\n\t});\n});\n","Meteor.publish('livechat:visitorHistory', function({ rid: roomId }) {\n\tif (!this.userId) {\n\t\treturn this.error(new Meteor.Error('error-not-authorized', 'Not authorized', { publish: 'livechat:visitorHistory' }));\n\t}\n\n\tif (!RocketChat.authz.hasPermission(this.userId, 'view-l-room')) {\n\t\treturn this.error(new Meteor.Error('error-not-authorized', 'Not authorized', { publish: 'livechat:visitorHistory' }));\n\t}\n\n\tvar room = RocketChat.models.Rooms.findOneById(roomId);\n\n\tconst user = RocketChat.models.Users.findOneById(this.userId);\n\n\tif (room.usernames.indexOf(user.username) === -1) {\n\t\treturn this.error(new Meteor.Error('error-not-authorized', 'Not authorized', { publish: 'livechat:visitorHistory' }));\n\t}\n\n\tif (room && room.v && room.v._id) {\n\t\treturn RocketChat.models.Rooms.findByVisitorId(room.v._id);\n\t} else {\n\t\treturn this.ready();\n\t}\n});\n","Meteor.publish('livechat:visitorInfo', function({ rid: roomId }) {\n\tif (!this.userId) {\n\t\treturn this.error(new Meteor.Error('error-not-authorized', 'Not authorized', { publish: 'livechat:visitorInfo' }));\n\t}\n\n\tif (!RocketChat.authz.hasPermission(this.userId, 'view-l-room')) {\n\t\treturn this.error(new Meteor.Error('error-not-authorized', 'Not authorized', { publish: 'livechat:visitorInfo' }));\n\t}\n\n\tvar room = RocketChat.models.Rooms.findOneById(roomId);\n\n\tif (room && room.v && room.v._id) {\n\t\treturn RocketChat.models.Users.findById(room.v._id);\n\t} else {\n\t\treturn this.ready();\n\t}\n});\n","Meteor.publish('livechat:visitorPageVisited', function({ rid: roomId }) {\n\tif (!this.userId) {\n\t\treturn this.error(new Meteor.Error('error-not-authorized', 'Not authorized', { publish: 'livechat:visitorPageVisited' }));\n\t}\n\n\tif (!RocketChat.authz.hasPermission(this.userId, 'view-l-room')) {\n\t\treturn this.error(new Meteor.Error('error-not-authorized', 'Not authorized', { publish: 'livechat:visitorPageVisited' }));\n\t}\n\n\tvar room = RocketChat.models.Rooms.findOneById(roomId);\n\n\tif (room && room.v && room.v.token) {\n\t\treturn RocketChat.models.LivechatPageVisited.findByToken(room.v.token);\n\t} else {\n\t\treturn this.ready();\n\t}\n});\n","Meteor.publish('livechat:inquiry', function() {\n\tif (!this.userId) {\n\t\treturn this.error(new Meteor.Error('error-not-authorized', 'Not authorized', { publish: 'livechat:inquiry' }));\n\t}\n\n\tif (!RocketChat.authz.hasPermission(this.userId, 'view-l-room')) {\n\t\treturn this.error(new Meteor.Error('error-not-authorized', 'Not authorized', { publish: 'livechat:inquiry' }));\n\t}\n\n\n\treturn RocketChat.models.LivechatInquiry.find();\n});\n","/* globals Restivus */\nconst Api = new Restivus({\n\tapiPath: 'livechat-api/',\n\tuseDefaultAuth: true,\n\tprettyJson: true\n});\n\nApi.addRoute('sms-incoming/:service', {\n\tpost() {\n\t\tconst SMSService = RocketChat.SMS.getService(this.urlParams.service);\n\n\t\tconst sms = SMSService.parse(this.bodyParams);\n\n\t\tvar visitor = RocketChat.models.Users.findOneVisitorByPhone(sms.from);\n\n\t\tlet sendMessage = {\n\t\t\tmessage: {\n\t\t\t\t_id: Random.id()\n\t\t\t},\n\t\t\troomInfo: {\n\t\t\t\tsms: {\n\t\t\t\t\tfrom: sms.to\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tif (visitor) {\n\t\t\tconst rooms = RocketChat.models.Rooms.findOpenByVisitorToken(visitor.profile.token).fetch();\n\n\t\t\tif (rooms && rooms.length > 0) {\n\t\t\t\tsendMessage.message.rid = rooms[0]._id;\n\t\t\t} else {\n\t\t\t\tsendMessage.message.rid = Random.id();\n\t\t\t}\n\t\t\tsendMessage.message.token = visitor.profile.token;\n\t\t} else {\n\t\t\tsendMessage.message.rid = Random.id();\n\t\t\tsendMessage.message.token = Random.id();\n\n\t\t\tlet userId = RocketChat.Livechat.registerGuest({\n\t\t\t\tusername: sms.from.replace(/[^0-9]/g, ''),\n\t\t\t\ttoken: sendMessage.message.token,\n\t\t\t\tphone: {\n\t\t\t\t\tnumber: sms.from\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tvisitor = RocketChat.models.Users.findOneById(userId);\n\t\t}\n\n\t\tsendMessage.message.msg = sms.body;\n\t\tsendMessage.guest = visitor;\n\n\t\ttry {\n\t\t\tconst message = SMSService.response.call(this, RocketChat.Livechat.sendMessage(sendMessage));\n\n\t\t\tMeteor.defer(() => {\n\t\t\t\tif (sms.extra) {\n\t\t\t\t\tif (sms.extra.fromCountry) {\n\t\t\t\t\t\tMeteor.call('livechat:setCustomField', sendMessage.message.token, 'country', sms.extra.fromCountry);\n\t\t\t\t\t}\n\t\t\t\t\tif (sms.extra.fromState) {\n\t\t\t\t\t\tMeteor.call('livechat:setCustomField', sendMessage.message.token, 'state', sms.extra.fromState);\n\t\t\t\t\t}\n\t\t\t\t\tif (sms.extra.fromCity) {\n\t\t\t\t\t\tMeteor.call('livechat:setCustomField', sendMessage.message.token, 'city', sms.extra.fromCity);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn message;\n\t\t} catch (e) {\n\t\t\treturn SMSService.error.call(this, e);\n\t\t}\n\t}\n});\n"]}